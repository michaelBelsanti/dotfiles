/**
 * @license
 * Lodash (Custom Build) lodash.com/license | Underscore.js 1.8.3 underscorejs.org/LICENSE
 * Build: `lodash include="remove,escape,dropRightWhile,toPairs,memoize,pull" exports="amd"`
 */
(function(){function t(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function e(t,e){for(var n=-1,r=null==t?0:t.length,o=Array(r);++n<r;)o[n]=e(t[n],n,t);return o}function n(t,e){for(var n=-1,r=e.length,o=t.length;++n<r;)t[o+n]=e[n];return t}function r(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}function o(t,e,n){return e==e?function(t,e,n){for(var r=n-1,o=t.length;++r<o;)if(t[r]===e)return r;return-1}(t,e,n):function(t,e,n,r){for(var o=t.length,i=n+(r?1:-1);r?i--:++i<o;)if(e(t[i],i,t))return i;return-1}(t,a,n)}function i(t,e,n,r){for(var o=n-1,i=t.length;++o<i;)if(r(t[o],e))return o;return-1}function a(t){return t!=t}function s(t){return function(e){return t(e)}}function c(t,e){return t.has(e)}function u(t){var e=-1,n=Array(t.size);return t.forEach((function(t,r){n[++e]=[r,t]})),n}function l(t,e){return function(n){return t(e(n))}}function f(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}function p(){}function h(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function d(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function _(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function v(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new _;++e<n;)this.add(t[e])}function y(t){this.size=(this.__data__=new d(t)).size}function g(t,e){var n=Sn(t),r=!n&&On(t),o=!n&&!r&&Fn(t),i=!n&&!r&&!o&&An(t),a=n||r||o||i,s=a?function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}(t.length,String):[],c=s.length;for(var u in t)!e&&!Ne.call(t,u)||a&&("length"==u||o&&("offset"==u||"parent"==u)||i&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||z(u,c))||s.push(u);return s}function b(t,e,n){var r=t[e];Ne.call(t,e)&&nt(r,n)&&(n!==mt||e in t)||w(t,e,n)}function m(t,e){for(var n=t.length;n--;)if(nt(t[n][0],e))return n;return-1}function w(t,e,n){"__proto__"==e&&Ye?Ye(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function k(t,e,n,r,o,i){var a,s=e&Et,c=e&Tt,u=e&Ot;if(n&&(a=o?n(t,r,o,i):n(t)),a!==mt)return a;if(!at(t))return t;var l=Sn(t);if(l){if(a=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&Ne.call(t,"index")&&(n.index=t.index,n.input=t.input),n}(t),!s)return U(t,a)}else{var f=jn(t),p=f==Mt||f==Ht;if(Fn(t))return function(t,e){if(e)return t.slice();var n=t.length,r=Ke?Ke(n):new t.constructor(n);return t.copy(r),r}(t,s);if(f==zt||f==It||p&&!o){if(a=c||p?{}:function(t){return"function"!=typeof t.constructor||G(t)?{}:bn(Ge(t))}(t),!s)return c?function(t,e){return L(t,kn(t),e)}(t,function(t,e){return t&&L(e,ht(e),t)}(a,t)):function(t,e){return L(t,wn(t),e)}(t,function(t,e){return t&&L(e,pt(e),t)}(a,t))}else{if(!we[f])return o?t:{};a=function(t,e,n){var r=t.constructor;switch(e){case te:return D(t);case Ut:case Lt:return new r(+t);case ee:return function(t,e){return new t.constructor(e?D(t.buffer):t.buffer,t.byteOffset,t.byteLength)}(t,n);case ne:case re:case oe:case ie:case ae:case se:case ce:case ue:case le:return function(t,e){return new t.constructor(e?D(t.buffer):t.buffer,t.byteOffset,t.length)}(t,n);case Vt:return new r;case $t:case Xt:return new r(t);case Qt:return function(t){var e=new t.constructor(t.source,ye.exec(t));return e.lastIndex=t.lastIndex,e}(t);case Wt:return new r;case Jt:return function(t){return yn?Object(yn.call(t)):{}}(t)}}(t,f,s)}}i||(i=new y);var h=i.get(t);if(h)return h;if(i.set(t,a),Pn(t))return t.forEach((function(r){a.add(k(r,e,n,r,t,i))})),a;if(xn(t))return t.forEach((function(r,o){a.set(o,k(r,e,n,o,t,i))})),a;var d=l?mt:(u?c?H:M:c?ht:pt)(t);return function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););}(d||t,(function(r,o){d&&(r=t[o=r]),b(a,o,k(r,e,n,o,t,i))})),a}function j(t,e){for(var n=0,r=(e=B(e,t)).length;null!=t&&n<r;)t=t[J(e[n++])];return n&&n==r?t:mt}function C(t,e,r){var o=e(t);return Sn(t)?o:n(o,r(t))}function E(t){return null==t?t===mt?Yt:qt:Je&&Je in Object(t)?function(t){var e=Ne.call(t,Je),n=t[Je];try{t[Je]=mt;var r=!0}catch(t){}var o=He.call(t);return r&&(e?t[Je]=n:delete t[Je]),o}(t):function(t){return He.call(t)}(t)}function T(t,e){return null!=t&&e in Object(t)}function O(t){return st(t)&&E(t)==It}function S(t,e,n,r,o){return t===e||(null==t||null==e||!st(t)&&!st(e)?t!=t&&e!=e:function(t,e,n,r,o,i){var a=Sn(t),s=Sn(e),c=a?Bt:jn(t),l=s?Bt:jn(e),p=(c=c==It?zt:c)==zt,h=(l=l==It?zt:l)==zt,d=c==l;if(d&&Fn(t)){if(!Fn(e))return!1;a=!0,p=!1}if(d&&!p)return i||(i=new y),a||An(t)?N(t,e,n,r,o,i):function(t,e,n,r,o,i,a){switch(n){case ee:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case te:return!(t.byteLength!=e.byteLength||!i(new ze(t),new ze(e)));case Ut:case Lt:case $t:return nt(+t,+e);case Nt:return t.name==e.name&&t.message==e.message;case Qt:case Xt:return t==e+"";case Vt:var s=u;case Wt:var c=r&St;if(s||(s=f),t.size!=e.size&&!c)return!1;var l=a.get(t);if(l)return l==e;r|=Ft,a.set(t,e);var p=N(s(t),s(e),r,o,i,a);return a.delete(t),p;case Jt:if(yn)return yn.call(t)==yn.call(e)}return!1}(t,e,c,n,r,o,i);if(!(n&St)){var _=p&&Ne.call(t,"__wrapped__"),v=h&&Ne.call(e,"__wrapped__");if(_||v){var g=_?t.value():t,b=v?e.value():e;return i||(i=new y),o(g,b,n,r,i)}}return!!d&&(i||(i=new y),function(t,e,n,r,o,i){var a=n&St,s=M(t),c=s.length;if(c!=M(e).length&&!a)return!1;for(var u=c;u--;){var l=s[u];if(!(a?l in e:Ne.call(e,l)))return!1}var f=i.get(t);if(f&&i.get(e))return f==e;var p=!0;i.set(t,e),i.set(e,t);for(var h=a;++u<c;){var d=t[l=s[u]],_=e[l];if(r)var v=a?r(_,d,l,e,t,i):r(d,_,l,t,e,i);if(!(v===mt?d===_||o(d,_,n,r,i):v)){p=!1;break}h||(h="constructor"==l)}if(p&&!h){var y=t.constructor,g=e.constructor;y!=g&&"constructor"in t&&"constructor"in e&&!("function"==typeof y&&y instanceof y&&"function"==typeof g&&g instanceof g)&&(p=!1)}return i.delete(t),i.delete(e),p}(t,e,n,r,o,i))}(t,e,n,r,S,o))}function F(t){return!(!at(t)||function(t){return!!Me&&Me in t}(t))&&(ot(t)?Ve:ge).test(Y(t))}function x(t){return"function"==typeof t?t:null==t?_t:"object"==typeof t?Sn(t)?function(t,e){return K(t)&&Q(e)?W(J(t),e):function(n){var r=lt(n,t);return r===mt&&r===e?ft(n,t):S(e,r,St|Ft)}}(t[0],t[1]):function(t){var e=function(t){for(var e=pt(t),n=e.length;n--;){var r=e[n],o=t[r];e[n]=[r,o,Q(o)]}return e}(t);return 1==e.length&&e[0][2]?W(e[0][0],e[0][1]):function(n){return n===t||function(t,e,n,r){var o=n.length,i=o,a=!r;if(null==t)return!i;for(t=Object(t);o--;){var s=n[o];if(a&&s[2]?s[1]!==t[s[0]]:!(s[0]in t))return!1}for(;++o<i;){var c=(s=n[o])[0],u=t[c],l=s[1];if(a&&s[2]){if(u===mt&&!(c in t))return!1}else{var f=new y;if(r)var p=r(u,l,c,t,e,f);if(!(p===mt?S(l,u,St|Ft,r,f):p))return!1}}return!0}(n,t,e)}}(t):yt(t)}function P(t){if(!at(t))return function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}(t);var e=G(t),n=[];for(var r in t)("constructor"!=r||!e&&Ne.call(t,r))&&n.push(r);return n}function A(t,e,n){var r=-1,o=t.length;e<0&&(e=-e>o?0:o+e),(n=n>o?o:n)<0&&(n+=o),o=e>n?0:n-e>>>0,e>>>=0;for(var i=Array(o);++r<o;)i[r]=t[r+e];return i}function R(t){if("string"==typeof t)return t;if(Sn(t))return e(t,R)+"";if(ct(t))return gn?gn.call(t):"";var n=t+"";return"0"==n&&1/t==-At?"-0":n}function I(t,e){return null==(t=function(t,e){return e.length<2?t:j(t,A(e,0,-1))}(t,e=B(e,t)))||delete t[J(Z(e))]}function B(t,e){return Sn(t)?t:K(t,e)?[t]:En(ut(t))}function D(t){var e=new t.constructor(t.byteLength);return new ze(e).set(new ze(t)),e}function U(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}function L(t,e,n,r){var o=!n;n||(n={});for(var i=-1,a=e.length;++i<a;){var s=e[i],c=r?r(n[s],t[s],s,n,t):mt;c===mt&&(c=t[s]),o?w(n,s,c):b(n,s,c)}return n}function N(t,e,n,o,i,a){var s=n&St,u=t.length,l=e.length;if(u!=l&&!(s&&l>u))return!1;var f=a.get(t);if(f&&a.get(e))return f==e;var p=-1,h=!0,d=n&Ft?new v:mt;for(a.set(t,e),a.set(e,t);++p<u;){var _=t[p],y=e[p];if(o)var g=s?o(y,_,p,e,t,a):o(_,y,p,t,e,a);if(g!==mt){if(g)continue;h=!1;break}if(d){if(!r(e,(function(t,e){if(!c(d,e)&&(_===t||i(_,t,n,o,a)))return d.push(e)}))){h=!1;break}}else if(_!==y&&!i(_,y,n,o,a)){h=!1;break}}return a.delete(t),a.delete(e),h}function M(t){return C(t,pt,wn)}function H(t){return C(t,ht,kn)}function V(){var t=p.iteratee||vt;return t=t===vt?x:t,arguments.length?t(arguments[0],arguments[1]):t}function $(t,e){var n=t.__data__;return function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}(e)?n["string"==typeof e?"string":"hash"]:n.map}function q(t,e){var n=function(t,e){return null==t?mt:t[e]}(t,e);return F(n)?n:mt}function z(t,e){var n=typeof t;return!!(e=null==e?Rt:e)&&("number"==n||"symbol"!=n&&be.test(t))&&t>-1&&t%1==0&&t<e}function K(t,e){if(Sn(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!ct(t))||de.test(t)||!he.test(t)||null!=e&&t in Object(e)}function G(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||De)}function Q(t){return t==t&&!at(t)}function W(t,e){return function(n){return null!=n&&n[t]===e&&(e!==mt||t in Object(n))}}function X(e,n,r){return n=nn(n===mt?e.length-1:n,0),function(){for(var o=arguments,i=-1,a=nn(o.length-n,0),s=Array(a);++i<a;)s[i]=o[n+i];i=-1;for(var c=Array(n+1);++i<n;)c[i]=o[i];return c[n]=r(s),t(e,this,c)}}function J(t){if("string"==typeof t||ct(t))return t;var e=t+"";return"0"==e&&1/t==-At?"-0":e}function Y(t){if(null!=t){try{return Le.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Z(t){var e=null==t?0:t.length;return e?t[e-1]:mt}function tt(t,n){return t&&t.length&&n&&n.length?function(t,n,r,a){var c=a?i:o,u=-1,l=n.length,f=t;for(t===n&&(n=U(n)),r&&(f=e(t,s(r)));++u<l;)for(var p=0,h=n[u],d=r?r(h):h;(p=c(f,d,p,a))>-1;)f!==t&&Xe.call(f,p,1),Xe.call(t,p,1);return t}(t,n):t}function et(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(kt);var n=function(){var r=arguments,o=e?e.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var a=t.apply(this,r);return n.cache=i.set(o,a)||i,a};return n.cache=new(et.Cache||_),n}function nt(t,e){return t===e||t!=t&&e!=e}function rt(t){return null!=t&&it(t.length)&&!ot(t)}function ot(t){if(!at(t))return!1;var e=E(t);return e==Mt||e==Ht||e==Dt||e==Gt}function it(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=Rt}function at(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function st(t){return null!=t&&"object"==typeof t}function ct(t){return"symbol"==typeof t||st(t)&&E(t)==Jt}function ut(t){return null==t?"":R(t)}function lt(t,e,n){var r=null==t?mt:j(t,e);return r===mt?n:r}function ft(t,e){return null!=t&&function(t,e,n){for(var r=-1,o=(e=B(e,t)).length,i=!1;++r<o;){var a=J(e[r]);if(!(i=null!=t&&n(t,a)))break;t=t[a]}return i||++r!=o?i:!!(o=null==t?0:t.length)&&it(o)&&z(a,o)&&(Sn(t)||On(t))}(t,e,T)}function pt(t){return rt(t)?g(t):function(t){if(!G(t))return en(t);var e=[];for(var n in Object(t))Ne.call(t,n)&&"constructor"!=n&&e.push(n);return e}(t)}function ht(t){return rt(t)?g(t,!0):P(t)}function dt(t){return function(){return t}}function _t(t){return t}function vt(t){return x("function"==typeof t?t:k(t,Et))}function yt(t){return K(t)?function(t){return function(e){return null==e?mt:e[t]}}(J(t)):function(t){return function(e){return j(e,t)}}(t)}function gt(){return[]}function bt(){return!1}var mt,wt=200,kt="Expected a function",jt="__lodash_hash_undefined__",Ct=500,Et=1,Tt=2,Ot=4,St=1,Ft=2,xt=800,Pt=16,At=1/0,Rt=9007199254740991,It="[object Arguments]",Bt="[object Array]",Dt="[object AsyncFunction]",Ut="[object Boolean]",Lt="[object Date]",Nt="[object Error]",Mt="[object Function]",Ht="[object GeneratorFunction]",Vt="[object Map]",$t="[object Number]",qt="[object Null]",zt="[object Object]",Kt="[object Promise]",Gt="[object Proxy]",Qt="[object RegExp]",Wt="[object Set]",Xt="[object String]",Jt="[object Symbol]",Yt="[object Undefined]",Zt="[object WeakMap]",te="[object ArrayBuffer]",ee="[object DataView]",ne="[object Float32Array]",re="[object Float64Array]",oe="[object Int8Array]",ie="[object Int16Array]",ae="[object Int32Array]",se="[object Uint8Array]",ce="[object Uint8ClampedArray]",ue="[object Uint16Array]",le="[object Uint32Array]",fe=/[&<>"']/g,pe=RegExp(fe.source),he=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,de=/^\w*$/,_e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ve=/\\(\\)?/g,ye=/\w*$/,ge=/^\[object .+?Constructor\]$/,be=/^(?:0|[1-9]\d*)$/,me={};me[ne]=me[re]=me[oe]=me[ie]=me[ae]=me[se]=me[ce]=me[ue]=me[le]=!0,me[It]=me[Bt]=me[te]=me[Ut]=me[ee]=me[Lt]=me[Nt]=me[Mt]=me[Vt]=me[$t]=me[zt]=me[Qt]=me[Wt]=me[Xt]=me[Zt]=!1;var we={};we[It]=we[Bt]=we[te]=we[ee]=we[Ut]=we[Lt]=we[ne]=we[re]=we[oe]=we[ie]=we[ae]=we[Vt]=we[$t]=we[zt]=we[Qt]=we[Wt]=we[Xt]=we[Jt]=we[se]=we[ce]=we[ue]=we[le]=!0,we[Nt]=we[Mt]=we[Zt]=!1;var ke="object"==typeof global&&global&&global.Object===Object&&global,je="object"==typeof self&&self&&self.Object===Object&&self,Ce=ke||je||Function("return this")(),Ee="object"==typeof exports&&exports&&!exports.nodeType&&exports,Te=Ee&&"object"==typeof module&&module&&!module.nodeType&&module,Oe=Te&&Te.exports===Ee,Se=Oe&&ke.process,Fe=function(){try{return Se&&Se.binding&&Se.binding("util")}catch(t){}}(),xe=Fe&&Fe.isMap,Pe=Fe&&Fe.isSet,Ae=Fe&&Fe.isTypedArray,Re=function(t){return function(e){return null==t?mt:t[e]}}({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}),Ie=Array.prototype,Be=Function.prototype,De=Object.prototype,Ue=Ce["__core-js_shared__"],Le=Be.toString,Ne=De.hasOwnProperty,Me=function(){var t=/[^.]+$/.exec(Ue&&Ue.keys&&Ue.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),He=De.toString,Ve=RegExp("^"+Le.call(Ne).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),$e=Oe?Ce.Buffer:mt,qe=Ce.Symbol,ze=Ce.Uint8Array,Ke=$e?$e.allocUnsafe:mt,Ge=l(Object.getPrototypeOf,Object),Qe=Object.create,We=De.propertyIsEnumerable,Xe=Ie.splice,Je=qe?qe.toStringTag:mt,Ye=function(){try{var t=q(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),Ze=Object.getOwnPropertySymbols,tn=$e?$e.isBuffer:mt,en=l(Object.keys,Object),nn=Math.max,rn=Date.now,on=q(Ce,"DataView"),an=q(Ce,"Map"),sn=q(Ce,"Promise"),cn=q(Ce,"Set"),un=q(Ce,"WeakMap"),ln=q(Object,"create"),fn=Y(on),pn=Y(an),hn=Y(sn),dn=Y(cn),_n=Y(un),vn=qe?qe.prototype:mt,yn=vn?vn.valueOf:mt,gn=vn?vn.toString:mt,bn=function(){function t(){}return function(e){if(!at(e))return{};if(Qe)return Qe(e);t.prototype=e;var n=new t;return t.prototype=mt,n}}();h.prototype.clear=function(){this.__data__=ln?ln(null):{},this.size=0},h.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},h.prototype.get=function(t){var e=this.__data__;if(ln){var n=e[t];return n===jt?mt:n}return Ne.call(e,t)?e[t]:mt},h.prototype.has=function(t){var e=this.__data__;return ln?e[t]!==mt:Ne.call(e,t)},h.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=ln&&e===mt?jt:e,this},d.prototype.clear=function(){this.__data__=[],this.size=0},d.prototype.delete=function(t){var e=this.__data__,n=m(e,t);return!(n<0||(n==e.length-1?e.pop():Xe.call(e,n,1),--this.size,0))},d.prototype.get=function(t){var e=this.__data__,n=m(e,t);return n<0?mt:e[n][1]},d.prototype.has=function(t){return m(this.__data__,t)>-1},d.prototype.set=function(t,e){var n=this.__data__,r=m(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this},_.prototype.clear=function(){this.size=0,this.__data__={hash:new h,map:new(an||d),string:new h}},_.prototype.delete=function(t){var e=$(this,t).delete(t);return this.size-=e?1:0,e},_.prototype.get=function(t){return $(this,t).get(t)},_.prototype.has=function(t){return $(this,t).has(t)},_.prototype.set=function(t,e){var n=$(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this},v.prototype.add=v.prototype.push=function(t){return this.__data__.set(t,jt),this},v.prototype.has=function(t){return this.__data__.has(t)},y.prototype.clear=function(){this.__data__=new d,this.size=0},y.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},y.prototype.get=function(t){return this.__data__.get(t)},y.prototype.has=function(t){return this.__data__.has(t)},y.prototype.set=function(t,e){var n=this.__data__;if(n instanceof d){var r=n.__data__;if(!an||r.length<wt-1)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new _(r)}return n.set(t,e),this.size=n.size,this};var mn=Ye?function(t,e){return Ye(t,"toString",{configurable:!0,enumerable:!1,value:dt(e),writable:!0})}:_t,wn=Ze?function(t){return null==t?[]:(t=Object(t),function(t,e){for(var n=-1,r=null==t?0:t.length,o=0,i=[];++n<r;){var a=t[n];e(a,n,t)&&(i[o++]=a)}return i}(Ze(t),(function(e){return We.call(t,e)})))}:gt,kn=Ze?function(t){for(var e=[];t;)n(e,wn(t)),t=Ge(t);return e}:gt,jn=E;(on&&jn(new on(new ArrayBuffer(1)))!=ee||an&&jn(new an)!=Vt||sn&&jn(sn.resolve())!=Kt||cn&&jn(new cn)!=Wt||un&&jn(new un)!=Zt)&&(jn=function(t){var e=E(t),n=e==zt?t.constructor:mt,r=n?Y(n):"";if(r)switch(r){case fn:return ee;case pn:return Vt;case hn:return Kt;case dn:return Wt;case _n:return Zt}return e});var Cn=function(t){var e=0,n=0;return function(){var r=rn(),o=Pt-(r-n);if(n=r,o>0){if(++e>=xt)return arguments[0]}else e=0;return t.apply(mt,arguments)}}(mn),En=function(t){var e=et(t,(function(t){return n.size===Ct&&n.clear(),t})),n=e.cache;return e}((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(_e,(function(t,n,r,o){e.push(r?o.replace(ve,"$1"):n||t)})),e})),Tn=function(t,e){return Cn(X(t,e,_t),t+"")}(tt);et.Cache=_;var On=O(function(){return arguments}())?O:function(t){return st(t)&&Ne.call(t,"callee")&&!We.call(t,"callee")},Sn=Array.isArray,Fn=tn||bt,xn=xe?s(xe):function(t){return st(t)&&jn(t)==Vt},Pn=Pe?s(Pe):function(t){return st(t)&&jn(t)==Wt},An=Ae?s(Ae):function(t){return st(t)&&it(t.length)&&!!me[E(t)]},Rn=function(t){return function(n){var r=jn(n);return r==Vt?u(n):r==Wt?function(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=[t,t]})),n}(n):function(t,n){return e(n,(function(e){return[e,t[e]]}))}(n,t(n))}}(pt);p.constant=dt,p.dropRightWhile=function(t,e){return t&&t.length?function(t,e,n,r){for(var o=t.length,i=r?o:-1;(r?i--:++i<o)&&e(t[i],i,t););return n?A(t,r?0:i,r?i+1:o):A(t,r?i+1:0,r?o:i)}(t,V(e,3),!0,!0):[]},p.iteratee=vt,p.keys=pt,p.keysIn=ht,p.memoize=et,p.property=yt,p.pull=Tn,p.pullAll=tt,p.remove=function(t,e){var n=[];if(!t||!t.length)return n;var r=-1,o=[],i=t.length;for(e=V(e,3);++r<i;){var a=t[r];e(a,r,t)&&(n.push(a),o.push(r))}return function(t,e){for(var n=t?e.length:0,r=n-1;n--;){var o=e[n];if(n==r||o!==i){var i=o;z(o)?Xe.call(t,o,1):I(t,o)}}}(t,o),n},p.toPairs=Rn,p.entries=Rn,p.eq=nt,p.escape=function(t){return(t=ut(t))&&pe.test(t)?t.replace(fe,Re):t},p.get=lt,p.hasIn=ft,p.identity=_t,p.isArguments=On,p.isArray=Sn,p.isArrayLike=rt,p.isBuffer=Fn,p.isFunction=ot,p.isLength=it,p.isMap=xn,p.isObject=at,p.isObjectLike=st,p.isSet=Pn,p.isSymbol=ct,p.isTypedArray=An,p.last=Z,p.stubArray=gt,p.stubFalse=bt,p.toString=ut,p.VERSION="4.17.5","function"==typeof define&&"object"==typeof define.amd&&define.amd&&define("lodash",[],(function(){return p}))}).call(this),function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define("bluebird",[],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.Promise=t()}}((function(){return function t(e,n,r){function o(a,s){if(!n[a]){if(!e[a]){var c="function"==typeof _dereq_&&_dereq_;if(!s&&c)return c(a,!0);if(i)return i(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[a]={exports:{}};e[a][0].call(l.exports,(function(t){var n=e[a][1][t];return o(n||t)}),l,l.exports,t,e,n,r)}return n[a].exports}for(var i="function"==typeof _dereq_&&_dereq_,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(t,e,n){"use strict";function r(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new u(16),this._normalQueue=new u(16),this._haveDrainedQueues=!1,this._trampolineEnabled=!0;var t=this;this.drainQueues=function(){t._drainQueues()},this._schedule=c}function o(t,e,n){this._lateQueue.push(t,e,n),this._queueTick()}function i(t,e,n){this._normalQueue.push(t,e,n),this._queueTick()}function a(t){this._normalQueue._pushOne(t),this._queueTick()}var s;try{throw new Error}catch(t){s=t}var c=t("./schedule"),u=t("./queue"),l=t("./util");r.prototype.setScheduler=function(t){var e=this._schedule;return this._schedule=t,this._customScheduler=!0,e},r.prototype.hasCustomScheduler=function(){return this._customScheduler},r.prototype.enableTrampoline=function(){this._trampolineEnabled=!0},r.prototype.disableTrampolineIfNecessary=function(){l.hasDevTools&&(this._trampolineEnabled=!1)},r.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},r.prototype.fatalError=function(t,e){e?(process.stderr.write("Fatal "+(t instanceof Error?t.stack:t)+"\n"),process.exit(2)):this.throwLater(t)},r.prototype.throwLater=function(t,e){if(1===arguments.length&&(e=t,t=function(){throw e}),"undefined"!=typeof setTimeout)setTimeout((function(){t(e)}),0);else try{this._schedule((function(){t(e)}))}catch(t){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}},l.hasDevTools?(r.prototype.invokeLater=function(t,e,n){this._trampolineEnabled?o.call(this,t,e,n):this._schedule((function(){setTimeout((function(){t.call(e,n)}),100)}))},r.prototype.invoke=function(t,e,n){this._trampolineEnabled?i.call(this,t,e,n):this._schedule((function(){t.call(e,n)}))},r.prototype.settlePromises=function(t){this._trampolineEnabled?a.call(this,t):this._schedule((function(){t._settlePromises()}))}):(r.prototype.invokeLater=o,r.prototype.invoke=i,r.prototype.settlePromises=a),r.prototype._drainQueue=function(t){for(;t.length()>0;){var e=t.shift();if("function"==typeof e){var n=t.shift(),r=t.shift();e.call(n,r)}else e._settlePromises()}},r.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,this._drainQueue(this._lateQueue)},r.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},r.prototype._reset=function(){this._isTickUsed=!1},e.exports=r,e.exports.firstLineError=s},{"./queue":17,"./schedule":18,"./util":21}],2:[function(t,e,n){"use strict";e.exports=function(t,e,n,r){var o=!1,i=function(t,e){this._reject(e)},a=function(t,e){e.promiseRejectionQueued=!0,e.bindingPromise._then(i,i,null,this,t)},s=function(t,e){0==(50397184&this._bitField)&&this._resolveCallback(e.target)},c=function(t,e){e.promiseRejectionQueued||this._reject(t)};t.prototype.bind=function(i){o||(o=!0,t.prototype._propagateFrom=r.propagateFromFunction(),t.prototype._boundValue=r.boundValueFunction());var u=n(i),l=new t(e);l._propagateFrom(this,1);var f=this._target();if(l._setBoundTo(u),u instanceof t){var p={promiseRejectionQueued:!1,promise:l,target:f,bindingPromise:u};f._then(e,a,void 0,l,p),u._then(s,c,void 0,l,p),l._setOnCancel(u)}else l._resolveCallback(f);return l},t.prototype._setBoundTo=function(t){void 0!==t?(this._bitField=2097152|this._bitField,this._boundTo=t):this._bitField=-2097153&this._bitField},t.prototype._isBound=function(){return 2097152==(2097152&this._bitField)},t.bind=function(e,n){return t.resolve(n).bind(e)}}},{}],3:[function(t,e,n){"use strict";var r;"undefined"!=typeof Promise&&(r=Promise);var o=t("./promise")();o.noConflict=function(){try{Promise===o&&(Promise=r)}catch(t){}return o},e.exports=o},{"./promise":15}],4:[function(t,e,n){"use strict";e.exports=function(e,n,r,o){var i=t("./util"),a=i.tryCatch,s=i.errorObj,c=e._async;e.prototype.break=e.prototype.cancel=function(){if(!o.cancellation())return this._warn("cancellation is disabled");for(var t=this,e=t;t._isCancellable();){if(!t._cancelBy(e)){e._isFollowing()?e._followee().cancel():e._cancelBranched();break}var n=t._cancellationParent;if(null==n||!n._isCancellable()){t._isFollowing()?t._followee().cancel():t._cancelBranched();break}t._isFollowing()&&t._followee().cancel(),t._setWillBeCancelled(),e=t,t=n}},e.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},e.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0},e.prototype._cancelBy=function(t){return t===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),!!this._enoughBranchesHaveCancelled()&&(this._invokeOnCancel(),!0))},e.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},e.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),c.invoke(this._cancelPromises,this,void 0))},e.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},e.prototype._unsetOnCancel=function(){this._onCancelField=void 0},e.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},e.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},e.prototype._doInvokeOnCancel=function(t,e){if(i.isArray(t))for(var n=0;n<t.length;++n)this._doInvokeOnCancel(t[n],e);else if(void 0!==t)if("function"==typeof t){if(!e){var r=a(t).call(this._boundValue());r===s&&(this._attachExtraTrace(r.e),c.throwLater(r.e))}}else t._resultCancelled(this)},e.prototype._invokeOnCancel=function(){var t=this._onCancel();this._unsetOnCancel(),c.invoke(this._doInvokeOnCancel,this,t)},e.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},e.prototype._resultCancelled=function(){this.cancel()}}},{"./util":21}],5:[function(t,e,n){"use strict";e.exports=function(e){var n=t("./util"),r=t("./es5").keys,o=n.tryCatch,i=n.errorObj;return function(t,a,s){return function(c){var u=s._boundValue();t:for(var l=0;l<t.length;++l){var f=t[l];if(f===Error||null!=f&&f.prototype instanceof Error){if(c instanceof f)return o(a).call(u,c)}else if("function"==typeof f){var p=o(f).call(u,c);if(p===i)return p;if(p)return o(a).call(u,c)}else if(n.isObject(c)){for(var h=r(f),d=0;d<h.length;++d){var _=h[d];if(f[_]!=c[_])continue t}return o(a).call(u,c)}}return e}}}},{"./es5":10,"./util":21}],6:[function(t,e,n){"use strict";e.exports=function(t){function e(){this._trace=new e.CapturedTrace(n())}function n(){var t=o.length-1;return t>=0?o[t]:void 0}var r=!1,o=[];return t.prototype._promiseCreated=function(){},t.prototype._pushContext=function(){},t.prototype._popContext=function(){return null},t._peekContext=t.prototype._peekContext=function(){},e.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,o.push(this._trace))},e.prototype._popContext=function(){if(void 0!==this._trace){var t=o.pop(),e=t._promiseCreated;return t._promiseCreated=null,e}return null},e.CapturedTrace=null,e.create=function(){return r?new e:void 0},e.deactivateLongStackTraces=function(){},e.activateLongStackTraces=function(){var o=t.prototype._pushContext,i=t.prototype._popContext,a=t._peekContext,s=t.prototype._peekContext,c=t.prototype._promiseCreated;e.deactivateLongStackTraces=function(){t.prototype._pushContext=o,t.prototype._popContext=i,t._peekContext=a,t.prototype._peekContext=s,t.prototype._promiseCreated=c,r=!1},r=!0,t.prototype._pushContext=e.prototype._pushContext,t.prototype._popContext=e.prototype._popContext,t._peekContext=t.prototype._peekContext=n,t.prototype._promiseCreated=function(){var t=this._peekContext();t&&null==t._promiseCreated&&(t._promiseCreated=this)}},e}},{}],7:[function(t,e,n){"use strict";e.exports=function(e,n){function r(t,e){return{promise:e}}function o(){return!1}function i(t,e,n){var r=this;try{t(e,n,(function(t){if("function"!=typeof t)throw new TypeError("onCancel must be a function, got: "+F.toString(t));r._attachCancellationCallback(t)}))}catch(t){return t}}function a(t){if(!this._isCancellable())return this;var e=this._onCancel();void 0!==e?F.isArray(e)?e.push(t):this._setOnCancel([e,t]):this._setOnCancel(t)}function s(){return this._onCancelField}function c(t){this._onCancelField=t}function u(){this._cancellationParent=void 0,this._onCancelField=void 0}function l(t,e){if(0!=(1&e)){this._cancellationParent=t;var n=t._branchesRemainingToCancel;void 0===n&&(n=0),t._branchesRemainingToCancel=n+1}0!=(2&e)&&t._isBound()&&this._setBoundTo(t._boundTo)}function f(){var t=this._boundTo;return void 0!==t&&t instanceof e?t.isFulfilled()?t.value():void 0:t}function p(){this._trace=new k(this._peekContext())}function h(t,e){if(x(t)){var n=this._trace;if(void 0!==n&&e&&(n=n._parent),void 0!==n)n.attachExtraTrace(t);else if(!t.__stackCleaned__){var r=v(t);F.notEnumerableProp(t,"stack",r.message+"\n"+r.stack.join("\n")),F.notEnumerableProp(t,"__stackCleaned__",!0)}}}function d(t,n,r){if(X.warnings){var o,i=new S(t);if(n)r._attachExtraTrace(i);else if(X.longStackTraces&&(o=e._peekContext()))o.attachExtraTrace(i);else{var a=v(i);i.stack=a.message+"\n"+a.stack.join("\n")}z("warning",i)||y(i,"",!0)}}function _(t){for(var e=[],n=0;n<t.length;++n){var r=t[n],o="    (No stack trace)"===r||I.test(r),i=o&&G(r);o&&!i&&(D&&" "!==r.charAt(0)&&(r="    "+r),e.push(r))}return e}function v(t){var e=t.stack,n=t.toString();return e="string"==typeof e&&e.length>0?function(t){for(var e=t.stack.replace(/\s+$/g,"").split("\n"),n=0;n<e.length;++n){var r=e[n];if("    (No stack trace)"===r||I.test(r))break}return n>0&&"SyntaxError"!=t.name&&(e=e.slice(n)),e}(t):["    (No stack trace)"],{message:n,stack:"SyntaxError"==t.name?e:_(e)}}function y(t,e,n){if("undefined"!=typeof console){var r;if(F.isObject(t)){var o=t.stack;r=e+B(o,t)}else r=e+String(t);"function"==typeof E?E(r,n):("function"==typeof console.log||"object"==typeof console.log)&&console.log(r)}}function g(t,e,n,r){var o=!1;try{"function"==typeof e&&(o=!0,"rejectionHandled"===t?e(r):e(n,r))}catch(t){O.throwLater(t)}"unhandledRejection"===t?z(t,n,r)||o||y(n,"Unhandled rejection "):z(t,r)}function b(t){var e;if("function"==typeof t)e="[function "+(t.name||"anonymous")+"]";else{e=t&&"function"==typeof t.toString?t.toString():F.toString(t);if(/\[object [a-zA-Z0-9$_]+\]/.test(e))try{e=JSON.stringify(t)}catch(t){}0===e.length&&(e="(empty array)")}return"(<"+function(t){var e=41;return t.length<e?t:t.substr(0,e-3)+"..."}(e)+">, no stack trace)"}function m(){return"function"==typeof W}function w(t){var e=t.match(Q);return e?{fileName:e[1],line:parseInt(e[2],10)}:void 0}function k(t){this._parent=t,this._promisesCreated=0;var e=this._length=1+(void 0===t?0:t._length);W(this,k),e>32&&this.uncycle()}var j,C,E,T=e._getDomain,O=e._async,S=t("./errors").Warning,F=t("./util"),x=F.canAttachTrace,P=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,A=/\((?:timers\.js):\d+:\d+\)/,R=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,I=null,B=null,D=!1,U=!(0==F.env("BLUEBIRD_DEBUG")||!F.env("BLUEBIRD_DEBUG")&&"development"!==F.env("NODE_ENV")),L=!(0==F.env("BLUEBIRD_WARNINGS")||!U&&!F.env("BLUEBIRD_WARNINGS")),N=!(0==F.env("BLUEBIRD_LONG_STACK_TRACES")||!U&&!F.env("BLUEBIRD_LONG_STACK_TRACES")),M=0!=F.env("BLUEBIRD_W_FORGOTTEN_RETURN")&&(L||!!F.env("BLUEBIRD_W_FORGOTTEN_RETURN"));e.prototype.suppressUnhandledRejections=function(){var t=this._target();t._bitField=-1048577&t._bitField|524288},e.prototype._ensurePossibleRejectionHandled=function(){0==(524288&this._bitField)&&(this._setRejectionIsUnhandled(),O.invokeLater(this._notifyUnhandledRejection,this,void 0))},e.prototype._notifyUnhandledRejectionIsHandled=function(){g("rejectionHandled",j,void 0,this)},e.prototype._setReturnedNonUndefined=function(){this._bitField=268435456|this._bitField},e.prototype._returnedNonUndefined=function(){return 0!=(268435456&this._bitField)},e.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var t=this._settledValue();this._setUnhandledRejectionIsNotified(),g("unhandledRejection",C,t,this)}},e.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=262144|this._bitField},e.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-262145&this._bitField},e.prototype._isUnhandledRejectionNotified=function(){return(262144&this._bitField)>0},e.prototype._setRejectionIsUnhandled=function(){this._bitField=1048576|this._bitField},e.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-1048577&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},e.prototype._isRejectionUnhandled=function(){return(1048576&this._bitField)>0},e.prototype._warn=function(t,e,n){return d(t,e,n||this)},e.onPossiblyUnhandledRejection=function(t){var e=T();C="function"==typeof t?null===e?t:F.domainBind(e,t):void 0},e.onUnhandledRejectionHandled=function(t){var e=T();j="function"==typeof t?null===e?t:F.domainBind(e,t):void 0};var H=function(){};e.longStackTraces=function(){if(O.haveItemsQueued()&&!X.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");if(!X.longStackTraces&&m()){var t=e.prototype._captureStackTrace,r=e.prototype._attachExtraTrace;X.longStackTraces=!0,H=function(){if(O.haveItemsQueued()&&!X.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");e.prototype._captureStackTrace=t,e.prototype._attachExtraTrace=r,n.deactivateLongStackTraces(),O.enableTrampoline(),X.longStackTraces=!1},e.prototype._captureStackTrace=p,e.prototype._attachExtraTrace=h,n.activateLongStackTraces(),O.disableTrampolineIfNecessary()}},e.hasLongStackTraces=function(){return X.longStackTraces&&m()};var V=function(){try{if("function"==typeof CustomEvent){var t=new CustomEvent("CustomEvent");return F.global.dispatchEvent(t),function(t,e){var n=new CustomEvent(t.toLowerCase(),{detail:e,cancelable:!0});return!F.global.dispatchEvent(n)}}if("function"==typeof Event){t=new Event("CustomEvent");return F.global.dispatchEvent(t),function(t,e){var n=new Event(t.toLowerCase(),{cancelable:!0});return n.detail=e,!F.global.dispatchEvent(n)}}return(t=document.createEvent("CustomEvent")).initCustomEvent("testingtheevent",!1,!0,{}),F.global.dispatchEvent(t),function(t,e){var n=document.createEvent("CustomEvent");return n.initCustomEvent(t.toLowerCase(),!1,!0,e),!F.global.dispatchEvent(n)}}catch(t){}return function(){return!1}}(),$=F.isNode?function(){return process.emit.apply(process,arguments)}:F.global?function(t){var e="on"+t.toLowerCase(),n=F.global[e];return!!n&&(n.apply(F.global,[].slice.call(arguments,1)),!0)}:function(){return!1},q={promiseCreated:r,promiseFulfilled:r,promiseRejected:r,promiseResolved:r,promiseCancelled:r,promiseChained:function(t,e,n){return{promise:e,child:n}},warning:function(t,e){return{warning:e}},unhandledRejection:function(t,e,n){return{reason:e,promise:n}},rejectionHandled:r},z=function(t){var e=!1;try{e=$.apply(null,arguments)}catch(t){O.throwLater(t),e=!0}var n=!1;try{n=V(t,q[t].apply(null,arguments))}catch(t){O.throwLater(t),n=!0}return n||e};e.config=function(t){if("longStackTraces"in(t=Object(t))&&(t.longStackTraces?e.longStackTraces():!t.longStackTraces&&e.hasLongStackTraces()&&H()),"warnings"in t){var n=t.warnings;X.warnings=!!n,M=X.warnings,F.isObject(n)&&"wForgottenReturn"in n&&(M=!!n.wForgottenReturn)}if("cancellation"in t&&t.cancellation&&!X.cancellation){if(O.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");e.prototype._clearCancellationData=u,e.prototype._propagateFrom=l,e.prototype._onCancel=s,e.prototype._setOnCancel=c,e.prototype._attachCancellationCallback=a,e.prototype._execute=i,K=l,X.cancellation=!0}return"monitoring"in t&&(t.monitoring&&!X.monitoring?(X.monitoring=!0,e.prototype._fireEvent=z):!t.monitoring&&X.monitoring&&(X.monitoring=!1,e.prototype._fireEvent=o)),e},e.prototype._fireEvent=o,e.prototype._execute=function(t,e,n){try{t(e,n)}catch(t){return t}},e.prototype._onCancel=function(){},e.prototype._setOnCancel=function(t){},e.prototype._attachCancellationCallback=function(t){},e.prototype._captureStackTrace=function(){},e.prototype._attachExtraTrace=function(){},e.prototype._clearCancellationData=function(){},e.prototype._propagateFrom=function(t,e){};var K=function(t,e){0!=(2&e)&&t._isBound()&&this._setBoundTo(t._boundTo)},G=function(){return!1},Q=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;F.inherits(k,Error),n.CapturedTrace=k,k.prototype.uncycle=function(){var t=this._length;if(!(2>t)){for(var e=[],n={},r=0,o=this;void 0!==o;++r)e.push(o),o=o._parent;for(r=(t=this._length=r)-1;r>=0;--r){var i=e[r].stack;void 0===n[i]&&(n[i]=r)}for(r=0;t>r;++r){var a=n[e[r].stack];if(void 0!==a&&a!==r){a>0&&(e[a-1]._parent=void 0,e[a-1]._length=1),e[r]._parent=void 0,e[r]._length=1;var s=r>0?e[r-1]:this;t-1>a?(s._parent=e[a+1],s._parent.uncycle(),s._length=s._parent._length+1):(s._parent=void 0,s._length=1);for(var c=s._length+1,u=r-2;u>=0;--u)e[u]._length=c,c++;return}}}},k.prototype.attachExtraTrace=function(t){if(!t.__stackCleaned__){this.uncycle();for(var e=v(t),n=e.message,r=[e.stack],o=this;void 0!==o;)r.push(_(o.stack.split("\n"))),o=o._parent;(function(t){for(var e=t[0],n=1;n<t.length;++n){for(var r=t[n],o=e.length-1,i=e[o],a=-1,s=r.length-1;s>=0;--s)if(r[s]===i){a=s;break}for(s=a;s>=0;--s){var c=r[s];if(e[o]!==c)break;e.pop(),o--}e=r}})(r),function(t){for(var e=0;e<t.length;++e)(0===t[e].length||e+1<t.length&&t[e][0]===t[e+1][0])&&(t.splice(e,1),e--)}(r),F.notEnumerableProp(t,"stack",function(t,e){for(var n=0;n<e.length-1;++n)e[n].push("From previous event:"),e[n]=e[n].join("\n");return n<e.length&&(e[n]=e[n].join("\n")),t+"\n"+e.join("\n")}(n,r)),F.notEnumerableProp(t,"__stackCleaned__",!0)}};var W=function(){var t=/^\s*at\s*/,e=function(t,e){return"string"==typeof t?t:void 0!==e.name&&void 0!==e.message?e.toString():b(e)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit+=6,I=t,B=e;var n=Error.captureStackTrace;return G=function(t){return P.test(t)},function(t,e){Error.stackTraceLimit+=6,n(t,e),Error.stackTraceLimit-=6}}var r,o=new Error;if("string"==typeof o.stack&&o.stack.split("\n")[0].indexOf("stackDetection@")>=0)return I=/@/,B=e,D=!0,function(t){t.stack=(new Error).stack};try{throw new Error}catch(t){r="stack"in t}return"stack"in o||!r||"number"!=typeof Error.stackTraceLimit?(B=function(t,e){return"string"==typeof t?t:"object"!=typeof e&&"function"!=typeof e||void 0===e.name||void 0===e.message?b(e):e.toString()},null):(I=t,B=e,function(t){Error.stackTraceLimit+=6;try{throw new Error}catch(e){t.stack=e.stack}Error.stackTraceLimit-=6})}();"undefined"!=typeof console&&void 0!==console.warn&&(E=function(t){console.warn(t)},F.isNode&&process.stderr.isTTY?E=function(t,e){var n=e?"[33m":"[31m";console.warn(n+t+"[0m\n")}:F.isNode||"string"!=typeof(new Error).stack||(E=function(t,e){console.warn("%c"+t,e?"color: darkorange":"color: red")}));var X={warnings:L,longStackTraces:!1,cancellation:!1,monitoring:!1};return N&&e.longStackTraces(),{longStackTraces:function(){return X.longStackTraces},warnings:function(){return X.warnings},cancellation:function(){return X.cancellation},monitoring:function(){return X.monitoring},propagateFromFunction:function(){return K},boundValueFunction:function(){return f},checkForgottenReturns:function(t,e,n,r,o){if(void 0===t&&null!==e&&M){if(void 0!==o&&o._returnedNonUndefined())return;if(0==(65535&r._bitField))return;n&&(n+=" ");var i="",a="";if(e._trace){for(var s=e._trace.stack.split("\n"),c=_(s),u=c.length-1;u>=0;--u){var l=c[u];if(!A.test(l)){var f=l.match(R);f&&(i="at "+f[1]+":"+f[2]+":"+f[3]+" ");break}}if(c.length>0){var p=c[0];for(u=0;u<s.length;++u)if(s[u]===p){u>0&&(a="\n"+s[u-1]);break}}}var h="a promise was created in a "+n+"handler "+i+"but was not returned from it, see http://goo.gl/rRqMUw"+a;r._warn(h,!0,e)}},setBounds:function(t,e){if(m()){for(var n,r,o=t.stack.split("\n"),i=e.stack.split("\n"),a=-1,s=-1,c=0;c<o.length;++c){if(u=w(o[c])){n=u.fileName,a=u.line;break}}for(c=0;c<i.length;++c){var u;if(u=w(i[c])){r=u.fileName,s=u.line;break}}0>a||0>s||!n||!r||n!==r||a>=s||(G=function(t){if(P.test(t))return!0;var e=w(t);return!!(e&&e.fileName===n&&a<=e.line&&e.line<=s)})}},warn:d,deprecated:function(t,e){var n=t+" is deprecated and will be removed in a future version.";return e&&(n+=" Use "+e+" instead."),d(n)},CapturedTrace:k,fireDomEvent:V,fireGlobalEvent:$}}},{"./errors":9,"./util":21}],8:[function(t,e,n){"use strict";e.exports=function(t){function e(){return this.value}function n(){throw this.reason}t.prototype.return=t.prototype.thenReturn=function(n){return n instanceof t&&n.suppressUnhandledRejections(),this._then(e,void 0,void 0,{value:n},void 0)},t.prototype.throw=t.prototype.thenThrow=function(t){return this._then(n,void 0,void 0,{reason:t},void 0)},t.prototype.catchThrow=function(t){if(arguments.length<=1)return this._then(void 0,n,void 0,{reason:t},void 0);var e=arguments[1],r=function(){throw e};return this.caught(t,r)},t.prototype.catchReturn=function(n){if(arguments.length<=1)return n instanceof t&&n.suppressUnhandledRejections(),this._then(void 0,e,void 0,{value:n},void 0);var r=arguments[1];r instanceof t&&r.suppressUnhandledRejections();var o=function(){return r};return this.caught(n,o)}}},{}],9:[function(t,e,n){"use strict";function r(t,e){function n(r){return this instanceof n?(f(this,"message","string"==typeof r?r:e),f(this,"name",t),void(Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this))):new n(r)}return l(n,Error),n}function o(t){return this instanceof o?(f(this,"name","OperationalError"),f(this,"message",t),this.cause=t,this.isOperational=!0,void(t instanceof Error?(f(this,"message",t.message),f(this,"stack",t.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor))):new o(t)}var i,a,s=t("./es5"),c=s.freeze,u=t("./util"),l=u.inherits,f=u.notEnumerableProp,p=r("Warning","warning"),h=r("CancellationError","cancellation error"),d=r("TimeoutError","timeout error"),_=r("AggregateError","aggregate error");try{i=TypeError,a=RangeError}catch(t){i=r("TypeError","type error"),a=r("RangeError","range error")}for(var v="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),y=0;y<v.length;++y)"function"==typeof Array.prototype[v[y]]&&(_.prototype[v[y]]=Array.prototype[v[y]]);s.defineProperty(_.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),_.prototype.isOperational=!0;var g=0;_.prototype.toString=function(){var t=Array(4*g+1).join(" "),e="\n"+t+"AggregateError of:\n";g++,t=Array(4*g+1).join(" ");for(var n=0;n<this.length;++n){for(var r=this[n]===this?"[Circular AggregateError]":this[n]+"",o=r.split("\n"),i=0;i<o.length;++i)o[i]=t+o[i];e+=(r=o.join("\n"))+"\n"}return g--,e},l(o,Error);var b=Error.__BluebirdErrorTypes__;b||(b=c({CancellationError:h,TimeoutError:d,OperationalError:o,RejectionError:o,AggregateError:_}),s.defineProperty(Error,"__BluebirdErrorTypes__",{value:b,writable:!1,enumerable:!1,configurable:!1})),e.exports={Error:Error,TypeError:i,RangeError:a,CancellationError:b.CancellationError,OperationalError:b.OperationalError,TimeoutError:b.TimeoutError,AggregateError:b.AggregateError,Warning:p}},{"./es5":10,"./util":21}],10:[function(t,e,n){var r=function(){"use strict";return void 0===this}();if(r)e.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:r,propertyIsWritable:function(t,e){var n=Object.getOwnPropertyDescriptor(t,e);return!(n&&!n.writable&&!n.set)}};else{var o={}.hasOwnProperty,i={}.toString,a={}.constructor.prototype,s=function(t){var e=[];for(var n in t)o.call(t,n)&&e.push(n);return e};e.exports={isArray:function(t){try{return"[object Array]"===i.call(t)}catch(t){return!1}},keys:s,names:s,defineProperty:function(t,e,n){return t[e]=n.value,t},getDescriptor:function(t,e){return{value:t[e]}},freeze:function(t){return t},getPrototypeOf:function(t){try{return Object(t).constructor.prototype}catch(t){return a}},isES5:r,propertyIsWritable:function(){return!0}}}},{}],11:[function(t,e,n){"use strict";e.exports=function(e,n,r){function o(t,e,n){this.promise=t,this.type=e,this.handler=n,this.called=!1,this.cancelPromise=null}function i(t){this.finallyHandler=t}function a(t,e){return null!=t.cancelPromise&&(arguments.length>1?t.cancelPromise._reject(e):t.cancelPromise._cancel(),t.cancelPromise=null,!0)}function s(){return u.call(this,this.promise._target()._settledValue())}function c(t){return a(this,t)?void 0:(p.e=t,p)}function u(t){var o=this.promise,u=this.handler;if(!this.called){this.called=!0;var l=this.isFinallyHandler()?u.call(o._boundValue()):u.call(o._boundValue(),t);if(l===r)return l;if(void 0!==l){o._setReturnedNonUndefined();var h=n(l,o);if(h instanceof e){if(null!=this.cancelPromise){if(h._isCancelled()){var d=new f("late cancellation observer");return o._attachExtraTrace(d),p.e=d,p}h.isPending()&&h._attachCancellationCallback(new i(this))}return h._then(s,c,void 0,this,void 0)}}}return o.isRejected()?(a(this),p.e=t,p):(a(this),t)}var l=t("./util"),f=e.CancellationError,p=l.errorObj,h=t("./catch_filter")(r);return o.prototype.isFinallyHandler=function(){return 0===this.type},i.prototype._resultCancelled=function(){a(this.finallyHandler)},e.prototype._passThrough=function(t,e,n,r){return"function"!=typeof t?this.then():this._then(n,r,void 0,new o(this,e,t),void 0)},e.prototype.lastly=e.prototype.finally=function(t){return this._passThrough(t,0,u,u)},e.prototype.tap=function(t){return this._passThrough(t,1,u)},e.prototype.tapCatch=function(t){var n=arguments.length;if(1===n)return this._passThrough(t,1,void 0,u);var r,o=new Array(n-1),i=0;for(r=0;n-1>r;++r){var a=arguments[r];if(!l.isObject(a))return e.reject(new TypeError("tapCatch statement predicate: expecting an object but got "+l.classString(a)));o[i++]=a}o.length=i;var s=arguments[r];return this._passThrough(h(o,s,this),1,void 0,u)},o}},{"./catch_filter":5,"./util":21}],12:[function(t,e,n){"use strict";e.exports=function(e,n,r,o,i,a){var s=t("./util");s.canEvaluate,s.tryCatch,s.errorObj,e.join=function(){var t,e=arguments.length-1;e>0&&"function"==typeof arguments[e]&&(t=arguments[e]);var r=[].slice.call(arguments);t&&r.pop();var o=new n(r).promise();return void 0!==t?o.spread(t):o}}},{"./util":21}],13:[function(t,e,n){"use strict";e.exports=function(e,n,r,o,i){var a=t("./util"),s=a.tryCatch;e.method=function(t){if("function"!=typeof t)throw new e.TypeError("expecting a function but got "+a.classString(t));return function(){var r=new e(n);r._captureStackTrace(),r._pushContext();var o=s(t).apply(this,arguments),a=r._popContext();return i.checkForgottenReturns(o,a,"Promise.method",r),r._resolveFromSyncValue(o),r}},e.attempt=e.try=function(t){if("function"!=typeof t)return o("expecting a function but got "+a.classString(t));var r,c=new e(n);if(c._captureStackTrace(),c._pushContext(),arguments.length>1){i.deprecated("calling Promise.try with more than 1 argument");var u=arguments[1],l=arguments[2];r=a.isArray(u)?s(t).apply(l,u):s(t).call(l,u)}else r=s(t)();var f=c._popContext();return i.checkForgottenReturns(r,f,"Promise.try",c),c._resolveFromSyncValue(r),c},e.prototype._resolveFromSyncValue=function(t){t===a.errorObj?this._rejectCallback(t.e,!1):this._resolveCallback(t,!0)}}},{"./util":21}],14:[function(t,e,n){"use strict";function r(t){var e;if(function(t){return t instanceof Error&&s.getPrototypeOf(t)===Error.prototype}(t)){(e=new a(t)).name=t.name,e.message=t.message,e.stack=t.stack;for(var n=s.keys(t),r=0;r<n.length;++r){var i=n[r];c.test(i)||(e[i]=t[i])}return e}return o.markAsOriginatingFromRejection(t),t}var o=t("./util"),i=o.maybeWrapAsError,a=t("./errors").OperationalError,s=t("./es5"),c=/^(?:name|message|stack|cause)$/;e.exports=function(t,e){return function(n,o){if(null!==t){if(n){var a=r(i(n));t._attachExtraTrace(a),t._reject(a)}else if(e){var s=[].slice.call(arguments,1);t._fulfill(s)}else t._fulfill(o);t=null}}}},{"./errors":9,"./es5":10,"./util":21}],15:[function(t,e,n){"use strict";e.exports=function(){function n(){}function r(t){t!==b&&function(t,e){if(null==t||t.constructor!==r)throw new y("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/MqrFmX\n");if("function"!=typeof e)throw new y("expecting a function but got "+p.classString(e))}(this,t),this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._resolveFromExecutor(t),this._promiseCreated(),this._fireEvent("promiseCreated",this)}function o(t){this.promise._resolveCallback(t)}function i(t){this.promise._rejectCallback(t,!1)}function a(t){var e=new r(b);e._fulfillmentHandler0=t,e._rejectionHandler0=t,e._promise0=t,e._receiver0=t}var s,c=function(){return new y("circular promise resolution chain\n\n    See http://goo.gl/MqrFmX\n")},u=function(){return new r.PromiseInspection(this._target())},l=function(t){return r.reject(new y(t))},f={},p=t("./util");s=p.isNode?function(){var t=process.domain;return void 0===t&&(t=null),t}:function(){return null},p.notEnumerableProp(r,"_getDomain",s);var h=t("./es5"),d=t("./async"),_=new d;h.defineProperty(r,"_async",{value:_});var v=t("./errors"),y=r.TypeError=v.TypeError;r.RangeError=v.RangeError;var g=r.CancellationError=v.CancellationError;r.TimeoutError=v.TimeoutError,r.OperationalError=v.OperationalError,r.RejectionError=v.OperationalError,r.AggregateError=v.AggregateError;var b=function(){},m={},w={},k=t("./thenables")(r,b),j=t("./promise_array")(r,b,k,l,n),C=t("./context")(r),E=(C.create,t("./debuggability")(r,C)),T=(E.CapturedTrace,t("./finally")(r,k,w)),O=t("./catch_filter")(w),S=t("./nodeback"),F=p.errorObj,x=p.tryCatch;return r.prototype.toString=function(){return"[object Promise]"},r.prototype.caught=r.prototype.catch=function(t){var e=arguments.length;if(e>1){var n,r=new Array(e-1),o=0;for(n=0;e-1>n;++n){var i=arguments[n];if(!p.isObject(i))return l("Catch statement predicate: expecting an object but got "+p.classString(i));r[o++]=i}return r.length=o,t=arguments[n],this.then(void 0,O(r,t,this))}return this.then(void 0,t)},r.prototype.reflect=function(){return this._then(u,u,void 0,this,void 0)},r.prototype.then=function(t,e){if(E.warnings()&&arguments.length>0&&"function"!=typeof t&&"function"!=typeof e){var n=".then() only accepts functions but was passed: "+p.classString(t);arguments.length>1&&(n+=", "+p.classString(e)),this._warn(n)}return this._then(t,e,void 0,void 0,void 0)},r.prototype.done=function(t,e){this._then(t,e,void 0,void 0,void 0)._setIsFinal()},r.prototype.spread=function(t){return"function"!=typeof t?l("expecting a function but got "+p.classString(t)):this.all()._then(t,void 0,void 0,m,void 0)},r.prototype.toJSON=function(){var t={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(t.fulfillmentValue=this.value(),t.isFulfilled=!0):this.isRejected()&&(t.rejectionReason=this.reason(),t.isRejected=!0),t},r.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new j(this).promise()},r.prototype.error=function(t){return this.caught(p.originatesFromRejection,t)},r.getNewLibraryCopy=e.exports,r.is=function(t){return t instanceof r},r.fromNode=r.fromCallback=function(t){var e=new r(b);e._captureStackTrace();var n=arguments.length>1&&!!Object(arguments[1]).multiArgs,o=x(t)(S(e,n));return o===F&&e._rejectCallback(o.e,!0),e._isFateSealed()||e._setAsyncGuaranteed(),e},r.all=function(t){return new j(t).promise()},r.cast=function(t){var e=k(t);return e instanceof r||((e=new r(b))._captureStackTrace(),e._setFulfilled(),e._rejectionHandler0=t),e},r.resolve=r.fulfilled=r.cast,r.reject=r.rejected=function(t){var e=new r(b);return e._captureStackTrace(),e._rejectCallback(t,!0),e},r.setScheduler=function(t){if("function"!=typeof t)throw new y("expecting a function but got "+p.classString(t));return _.setScheduler(t)},r.prototype._then=function(t,e,n,o,i){var a=void 0!==i,c=a?i:new r(b),u=this._target(),l=u._bitField;a||(c._propagateFrom(this,3),c._captureStackTrace(),void 0===o&&0!=(2097152&this._bitField)&&(o=0!=(50397184&l)?this._boundValue():u===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,c));var f=s();if(0!=(50397184&l)){var h,d,v=u._settlePromiseCtx;0!=(33554432&l)?(d=u._rejectionHandler0,h=t):0!=(16777216&l)?(d=u._fulfillmentHandler0,h=e,u._unsetRejectionIsUnhandled()):(v=u._settlePromiseLateCancellationObserver,d=new g("late cancellation observer"),u._attachExtraTrace(d),h=e),_.invoke(v,u,{handler:null===f?h:"function"==typeof h&&p.domainBind(f,h),promise:c,receiver:o,value:d})}else u._addCallbacks(t,e,c,o,f);return c},r.prototype._length=function(){return 65535&this._bitField},r.prototype._isFateSealed=function(){return 0!=(117506048&this._bitField)},r.prototype._isFollowing=function(){return 67108864==(67108864&this._bitField)},r.prototype._setLength=function(t){this._bitField=-65536&this._bitField|65535&t},r.prototype._setFulfilled=function(){this._bitField=33554432|this._bitField,this._fireEvent("promiseFulfilled",this)},r.prototype._setRejected=function(){this._bitField=16777216|this._bitField,this._fireEvent("promiseRejected",this)},r.prototype._setFollowing=function(){this._bitField=67108864|this._bitField,this._fireEvent("promiseResolved",this)},r.prototype._setIsFinal=function(){this._bitField=4194304|this._bitField},r.prototype._isFinal=function(){return(4194304&this._bitField)>0},r.prototype._unsetCancelled=function(){this._bitField=-65537&this._bitField},r.prototype._setCancelled=function(){this._bitField=65536|this._bitField,this._fireEvent("promiseCancelled",this)},r.prototype._setWillBeCancelled=function(){this._bitField=8388608|this._bitField},r.prototype._setAsyncGuaranteed=function(){_.hasCustomScheduler()||(this._bitField=134217728|this._bitField)},r.prototype._receiverAt=function(t){var e=0===t?this._receiver0:this[4*t-4+3];return e===f?void 0:void 0===e&&this._isBound()?this._boundValue():e},r.prototype._promiseAt=function(t){return this[4*t-4+2]},r.prototype._fulfillmentHandlerAt=function(t){return this[4*t-4+0]},r.prototype._rejectionHandlerAt=function(t){return this[4*t-4+1]},r.prototype._boundValue=function(){},r.prototype._migrateCallback0=function(t){var e=(t._bitField,t._fulfillmentHandler0),n=t._rejectionHandler0,r=t._promise0,o=t._receiverAt(0);void 0===o&&(o=f),this._addCallbacks(e,n,r,o,null)},r.prototype._migrateCallbackAt=function(t,e){var n=t._fulfillmentHandlerAt(e),r=t._rejectionHandlerAt(e),o=t._promiseAt(e),i=t._receiverAt(e);void 0===i&&(i=f),this._addCallbacks(n,r,o,i,null)},r.prototype._addCallbacks=function(t,e,n,r,o){var i=this._length();if(i>=65531&&(i=0,this._setLength(0)),0===i)this._promise0=n,this._receiver0=r,"function"==typeof t&&(this._fulfillmentHandler0=null===o?t:p.domainBind(o,t)),"function"==typeof e&&(this._rejectionHandler0=null===o?e:p.domainBind(o,e));else{var a=4*i-4;this[a+2]=n,this[a+3]=r,"function"==typeof t&&(this[a+0]=null===o?t:p.domainBind(o,t)),"function"==typeof e&&(this[a+1]=null===o?e:p.domainBind(o,e))}return this._setLength(i+1),i},r.prototype._proxy=function(t,e){this._addCallbacks(void 0,void 0,e,t,null)},r.prototype._resolveCallback=function(t,e){if(0==(117506048&this._bitField)){if(t===this)return this._rejectCallback(c(),!1);var n=k(t,this);if(!(n instanceof r))return this._fulfill(t);e&&this._propagateFrom(n,2);var o=n._target();if(o===this)return void this._reject(c());var i=o._bitField;if(0==(50397184&i)){var a=this._length();a>0&&o._migrateCallback0(this);for(var s=1;a>s;++s)o._migrateCallbackAt(this,s);this._setFollowing(),this._setLength(0),this._setFollowee(o)}else if(0!=(33554432&i))this._fulfill(o._value());else if(0!=(16777216&i))this._reject(o._reason());else{var u=new g("late cancellation observer");o._attachExtraTrace(u),this._reject(u)}}},r.prototype._rejectCallback=function(t,e,n){var r=p.ensureErrorObject(t),o=r===t;if(!o&&!n&&E.warnings()){var i="a promise was rejected with a non-error: "+p.classString(t);this._warn(i,!0)}this._attachExtraTrace(r,!!e&&o),this._reject(t)},r.prototype._resolveFromExecutor=function(t){if(t!==b){var e=this;this._captureStackTrace(),this._pushContext();var n=!0,r=this._execute(t,(function(t){e._resolveCallback(t)}),(function(t){e._rejectCallback(t,n)}));n=!1,this._popContext(),void 0!==r&&e._rejectCallback(r,!0)}},r.prototype._settlePromiseFromHandler=function(t,e,n,r){var o=r._bitField;if(0==(65536&o)){var i;r._pushContext(),e===m?n&&"number"==typeof n.length?i=x(t).apply(this._boundValue(),n):(i=F).e=new y("cannot .spread() a non-array: "+p.classString(n)):i=x(t).call(e,n);var a=r._popContext();0==(65536&(o=r._bitField))&&(i===w?r._reject(n):i===F?r._rejectCallback(i.e,!1):(E.checkForgottenReturns(i,a,"",r,this),r._resolveCallback(i)))}},r.prototype._target=function(){for(var t=this;t._isFollowing();)t=t._followee();return t},r.prototype._followee=function(){return this._rejectionHandler0},r.prototype._setFollowee=function(t){this._rejectionHandler0=t},r.prototype._settlePromise=function(t,e,o,i){var a=t instanceof r,s=this._bitField,c=0!=(134217728&s);0!=(65536&s)?(a&&t._invokeInternalOnCancel(),o instanceof T&&o.isFinallyHandler()?(o.cancelPromise=t,x(e).call(o,i)===F&&t._reject(F.e)):e===u?t._fulfill(u.call(o)):o instanceof n?o._promiseCancelled(t):a||t instanceof j?t._cancel():o.cancel()):"function"==typeof e?a?(c&&t._setAsyncGuaranteed(),this._settlePromiseFromHandler(e,o,i,t)):e.call(o,i,t):o instanceof n?o._isResolved()||(0!=(33554432&s)?o._promiseFulfilled(i,t):o._promiseRejected(i,t)):a&&(c&&t._setAsyncGuaranteed(),0!=(33554432&s)?t._fulfill(i):t._reject(i))},r.prototype._settlePromiseLateCancellationObserver=function(t){var e=t.handler,n=t.promise,o=t.receiver,i=t.value;"function"==typeof e?n instanceof r?this._settlePromiseFromHandler(e,o,i,n):e.call(o,i,n):n instanceof r&&n._reject(i)},r.prototype._settlePromiseCtx=function(t){this._settlePromise(t.promise,t.handler,t.receiver,t.value)},r.prototype._settlePromise0=function(t,e,n){var r=this._promise0,o=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(r,t,o,e)},r.prototype._clearCallbackDataAtIndex=function(t){var e=4*t-4;this[e+2]=this[e+3]=this[e+0]=this[e+1]=void 0},r.prototype._fulfill=function(t){var e=this._bitField;if(!((117506048&e)>>>16)){if(t===this){var n=c();return this._attachExtraTrace(n),this._reject(n)}this._setFulfilled(),this._rejectionHandler0=t,(65535&e)>0&&(0!=(134217728&e)?this._settlePromises():_.settlePromises(this))}},r.prototype._reject=function(t){var e=this._bitField;if(!((117506048&e)>>>16))return this._setRejected(),this._fulfillmentHandler0=t,this._isFinal()?_.fatalError(t,p.isNode):void((65535&e)>0?_.settlePromises(this):this._ensurePossibleRejectionHandled())},r.prototype._fulfillPromises=function(t,e){for(var n=1;t>n;n++){var r=this._fulfillmentHandlerAt(n),o=this._promiseAt(n),i=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(o,r,i,e)}},r.prototype._rejectPromises=function(t,e){for(var n=1;t>n;n++){var r=this._rejectionHandlerAt(n),o=this._promiseAt(n),i=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(o,r,i,e)}},r.prototype._settlePromises=function(){var t=this._bitField,e=65535&t;if(e>0){if(0!=(16842752&t)){var n=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,n,t),this._rejectPromises(e,n)}else{var r=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,r,t),this._fulfillPromises(e,r)}this._setLength(0)}this._clearCancellationData()},r.prototype._settledValue=function(){var t=this._bitField;return 0!=(33554432&t)?this._rejectionHandler0:0!=(16777216&t)?this._fulfillmentHandler0:void 0},r.defer=r.pending=function(){return E.deprecated("Promise.defer","new Promise"),{promise:new r(b),resolve:o,reject:i}},p.notEnumerableProp(r,"_makeSelfResolutionError",c),t("./method")(r,b,k,l,E),t("./bind")(r,b,k,E),t("./cancel")(r,j,l,E),t("./direct_resolve")(r),t("./synchronous_inspection")(r),t("./join")(r,j,k,b,_,s),r.Promise=r,r.version="3.5.0",p.toFastProperties(r),p.toFastProperties(r.prototype),a({a:1}),a({b:2}),a({c:3}),a(1),a((function(){})),a(void 0),a(!1),a(new r(b)),E.setBounds(d.firstLineError,p.lastLineError),r}},{"./async":1,"./bind":2,"./cancel":4,"./catch_filter":5,"./context":6,"./debuggability":7,"./direct_resolve":8,"./errors":9,"./es5":10,"./finally":11,"./join":12,"./method":13,"./nodeback":14,"./promise_array":16,"./synchronous_inspection":19,"./thenables":20,"./util":21}],16:[function(t,e,n){"use strict";e.exports=function(e,n,r,o,i){function a(t){var r=this._promise=new e(n);t instanceof e&&r._propagateFrom(t,3),r._setOnCancel(this),this._values=t,this._length=0,this._totalResolved=0,this._init(void 0,-2)}var s=t("./util");return s.isArray,s.inherits(a,i),a.prototype.length=function(){return this._length},a.prototype.promise=function(){return this._promise},a.prototype._init=function t(n,i){var a=r(this._values,this._promise);if(a instanceof e){var c=(a=a._target())._bitField;if(this._values=a,0==(50397184&c))return this._promise._setAsyncGuaranteed(),a._then(t,this._reject,void 0,this,i);if(0==(33554432&c))return 0!=(16777216&c)?this._reject(a._reason()):this._cancel();a=a._value()}if(null!==(a=s.asArray(a)))return 0===a.length?void(-5===i?this._resolveEmptyArray():this._resolve(function(t){switch(t){case-2:return[];case-3:return{};case-6:return new Map}}(i))):void this._iterate(a);var u=o("expecting an array or an iterable object but got "+s.classString(a)).reason();this._promise._rejectCallback(u,!1)},a.prototype._iterate=function(t){var n=this.getActualLength(t.length);this._length=n,this._values=this.shouldCopyValues()?new Array(n):this._values;for(var o=this._promise,i=!1,a=null,s=0;n>s;++s){var c=r(t[s],o);c instanceof e?a=(c=c._target())._bitField:a=null,i?null!==a&&c.suppressUnhandledRejections():null!==a?0==(50397184&a)?(c._proxy(this,s),this._values[s]=c):i=0!=(33554432&a)?this._promiseFulfilled(c._value(),s):0!=(16777216&a)?this._promiseRejected(c._reason(),s):this._promiseCancelled(s):i=this._promiseFulfilled(c,s)}i||o._setAsyncGuaranteed()},a.prototype._isResolved=function(){return null===this._values},a.prototype._resolve=function(t){this._values=null,this._promise._fulfill(t)},a.prototype._cancel=function(){!this._isResolved()&&this._promise._isCancellable()&&(this._values=null,this._promise._cancel())},a.prototype._reject=function(t){this._values=null,this._promise._rejectCallback(t,!1)},a.prototype._promiseFulfilled=function(t,e){return this._values[e]=t,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},a.prototype._promiseCancelled=function(){return this._cancel(),!0},a.prototype._promiseRejected=function(t){return this._totalResolved++,this._reject(t),!0},a.prototype._resultCancelled=function(){if(!this._isResolved()){var t=this._values;if(this._cancel(),t instanceof e)t.cancel();else for(var n=0;n<t.length;++n)t[n]instanceof e&&t[n].cancel()}},a.prototype.shouldCopyValues=function(){return!0},a.prototype.getActualLength=function(t){return t},a}},{"./util":21}],17:[function(t,e,n){"use strict";function r(t){this._capacity=t,this._length=0,this._front=0}r.prototype._willBeOverCapacity=function(t){return this._capacity<t},r.prototype._pushOne=function(t){var e=this.length();this._checkCapacity(e+1),this[this._front+e&this._capacity-1]=t,this._length=e+1},r.prototype.push=function(t,e,n){var r=this.length()+3;if(this._willBeOverCapacity(r))return this._pushOne(t),this._pushOne(e),void this._pushOne(n);var o=this._front+r-3;this._checkCapacity(r);var i=this._capacity-1;this[o+0&i]=t,this[o+1&i]=e,this[o+2&i]=n,this._length=r},r.prototype.shift=function(){var t=this._front,e=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length--,e},r.prototype.length=function(){return this._length},r.prototype._checkCapacity=function(t){this._capacity<t&&this._resizeTo(this._capacity<<1)},r.prototype._resizeTo=function(t){var e=this._capacity;this._capacity=t,function(t,e,n,r,o){for(var i=0;o>i;++i)n[i+r]=t[i+e],t[i+e]=void 0}(this,0,this,e,this._front+this._length&e-1)},e.exports=r},{}],18:[function(t,e,n){"use strict";var r,o=t("./util"),i=o.getNativePromise();if(o.isNode&&"undefined"==typeof MutationObserver){var a=global.setImmediate,s=process.nextTick;r=o.isRecentNode?function(t){a.call(global,t)}:function(t){s.call(process,t)}}else if("function"==typeof i&&"function"==typeof i.resolve){var c=i.resolve();r=function(t){c.then(t)}}else r="undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&(window.navigator.standalone||window.cordova)?"undefined"!=typeof setImmediate?function(t){setImmediate(t)}:"undefined"!=typeof setTimeout?function(t){setTimeout(t,0)}:function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}:function(){var t=document.createElement("div"),e={attributes:!0},n=!1,r=document.createElement("div");new MutationObserver((function(){t.classList.toggle("foo"),n=!1})).observe(r,e);var o=function(){n||(n=!0,r.classList.toggle("foo"))};return function(n){var r=new MutationObserver((function(){r.disconnect(),n()}));r.observe(t,e),o()}}();e.exports=r},{"./util":21}],19:[function(t,e,n){"use strict";e.exports=function(t){function e(t){void 0!==t?(t=t._target(),this._bitField=t._bitField,this._settledValueField=t._isFateSealed()?t._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}e.prototype._settledValue=function(){return this._settledValueField};var n=e.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},r=e.prototype.error=e.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},o=e.prototype.isFulfilled=function(){return 0!=(33554432&this._bitField)},i=e.prototype.isRejected=function(){return 0!=(16777216&this._bitField)},a=e.prototype.isPending=function(){return 0==(50397184&this._bitField)},s=e.prototype.isResolved=function(){return 0!=(50331648&this._bitField)};e.prototype.isCancelled=function(){return 0!=(8454144&this._bitField)},t.prototype.__isCancelled=function(){return 65536==(65536&this._bitField)},t.prototype._isCancelled=function(){return this._target().__isCancelled()},t.prototype.isCancelled=function(){return 0!=(8454144&this._target()._bitField)},t.prototype.isPending=function(){return a.call(this._target())},t.prototype.isRejected=function(){return i.call(this._target())},t.prototype.isFulfilled=function(){return o.call(this._target())},t.prototype.isResolved=function(){return s.call(this._target())},t.prototype.value=function(){return n.call(this._target())},t.prototype.reason=function(){var t=this._target();return t._unsetRejectionIsUnhandled(),r.call(t)},t.prototype._value=function(){return this._settledValue()},t.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},t.PromiseInspection=e}},{}],20:[function(t,e,n){"use strict";e.exports=function(e,n){function r(t){try{return function(t){return t.then}(t)}catch(t){return a.e=t,a}}function o(t,r,o){var s=new e(n),c=s;o&&o._pushContext(),s._captureStackTrace(),o&&o._popContext();var u=!0,l=i.tryCatch(r).call(t,(function(t){s&&(s._resolveCallback(t),s=null)}),(function(t){s&&(s._rejectCallback(t,u,!0),s=null)}));return u=!1,s&&l===a&&(s._rejectCallback(l.e,!0,!0),s=null),c}var i=t("./util"),a=i.errorObj,s=i.isObject,c={}.hasOwnProperty;return function(t,i){if(s(t)){if(t instanceof e)return t;var u=r(t);if(u===a){i&&i._pushContext();var l=e.reject(u.e);return i&&i._popContext(),l}if("function"==typeof u){if(function(t){try{return c.call(t,"_promise0")}catch(t){return!1}}(t)){l=new e(n);return t._then(l._fulfill,l._reject,void 0,l,null),l}return o(t,u,i)}}return t}}},{"./util":21}],21:[function(t,e,n){"use strict";function r(){try{var t=l;return l=null,t.apply(this,arguments)}catch(t){return h.e=t,h}}function o(t){return null==t||!0===t||!1===t||"string"==typeof t||"number"==typeof t}function i(t,e,n){if(o(t))return t;var r={value:n,configurable:!0,enumerable:!1,writable:!0};return f.defineProperty(t,e,r),t}function a(t){try{return t+""}catch(t){return"[no string representation]"}}function s(t){return null!==t&&"object"==typeof t&&"string"==typeof t.message&&"string"==typeof t.name}function c(t){return s(t)&&f.propertyIsWritable(t,"stack")}function u(t){return{}.toString.call(t)}var l,f=t("./es5"),p="undefined"==typeof navigator,h={e:{}},d="undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:void 0!==this?this:null,_=function(){var t=[Array.prototype,Object.prototype,Function.prototype],e=function(e){for(var n=0;n<t.length;++n)if(t[n]===e)return!0;return!1};if(f.isES5){var n=Object.getOwnPropertyNames;return function(t){for(var r=[],o=Object.create(null);null!=t&&!e(t);){var i;try{i=n(t)}catch(t){return r}for(var a=0;a<i.length;++a){var s=i[a];if(!o[s]){o[s]=!0;var c=Object.getOwnPropertyDescriptor(t,s);null!=c&&null==c.get&&null==c.set&&r.push(s)}}t=f.getPrototypeOf(t)}return r}}var r={}.hasOwnProperty;return function(n){if(e(n))return[];var o=[];t:for(var i in n)if(r.call(n,i))o.push(i);else{for(var a=0;a<t.length;++a)if(r.call(t[a],i))continue t;o.push(i)}return o}}(),v=/this\s*\.\s*\S+\s*=/,y=/^[a-z$_][a-z$_0-9]*$/i,g="stack"in new Error?function(t){return c(t)?t:new Error(a(t))}:function(t){if(c(t))return t;try{throw new Error(a(t))}catch(t){return t}},b=function(t){return f.isArray(t)?t:null};if("undefined"!=typeof Symbol&&Symbol.iterator){var m="function"==typeof Array.from?function(t){return Array.from(t)}:function(t){for(var e,n=[],r=t[Symbol.iterator]();!(e=r.next()).done;)n.push(e.value);return n};b=function(t){return f.isArray(t)?t:null!=t&&"function"==typeof t[Symbol.iterator]?m(t):null}}var w="undefined"!=typeof process&&"[object process]"===u(process).toLowerCase(),k="undefined"!=typeof process&&void 0!==process.env,j={isClass:function(t){try{if("function"==typeof t){var e=f.names(t.prototype),n=f.isES5&&e.length>1,r=e.length>0&&!(1===e.length&&"constructor"===e[0]),o=v.test(t+"")&&f.names(t).length>0;if(n||r||o)return!0}return!1}catch(t){return!1}},isIdentifier:function(t){return y.test(t)},inheritedDataKeys:_,getDataPropertyOrDefault:function(t,e,n){if(!f.isES5)return{}.hasOwnProperty.call(t,e)?t[e]:void 0;var r=Object.getOwnPropertyDescriptor(t,e);return null!=r?null==r.get&&null==r.set?r.value:n:void 0},thrower:function(t){throw t},isArray:f.isArray,asArray:b,notEnumerableProp:i,isPrimitive:o,isObject:function(t){return"function"==typeof t||"object"==typeof t&&null!==t},isError:s,canEvaluate:p,errorObj:h,tryCatch:function(t){return l=t,r},inherits:function(t,e){function n(){for(var n in this.constructor=t,this.constructor$=e,e.prototype)r.call(e.prototype,n)&&"$"!==n.charAt(n.length-1)&&(this[n+"$"]=e.prototype[n])}var r={}.hasOwnProperty;return n.prototype=e.prototype,t.prototype=new n,t.prototype},withAppended:function(t,e){var n,r=t.length,o=new Array(r+1);for(n=0;r>n;++n)o[n]=t[n];return o[n]=e,o},maybeWrapAsError:function(t){return o(t)?new Error(a(t)):t},toFastProperties:function(t){function e(){}e.prototype=t;for(var n=8;n--;)new e;return t},filledRange:function(t,e,n){for(var r=new Array(t),o=0;t>o;++o)r[o]=e+o+n;return r},toString:a,canAttachTrace:c,ensureErrorObject:g,originatesFromRejection:function(t){return null!=t&&(t instanceof Error.__BluebirdErrorTypes__.OperationalError||!0===t.isOperational)},markAsOriginatingFromRejection:function(t){try{i(t,"isOperational",!0)}catch(t){}},classString:u,copyDescriptors:function(t,e,n){for(var r=f.names(t),o=0;o<r.length;++o){var i=r[o];if(n(i))try{f.defineProperty(e,i,f.getDescriptor(t,i))}catch(t){}}},hasDevTools:"undefined"!=typeof chrome&&chrome&&"function"==typeof chrome.loadTimes,isNode:w,hasEnvVariables:k,env:function(t){return k?process.env[t]:void 0},global:d,getNativePromise:function(){if("function"==typeof Promise)try{var t=new Promise((function(){}));if("[object Promise]"==={}.toString.call(t))return Promise}catch(t){}},domainBind:function(t,e){return t.bind(e)}};j.isRecentNode=j.isNode&&function(){var t=process.versions.node.split(".").map(Number);return 0===t[0]&&t[1]>10||t[0]>0}(),j.isNode&&j.toFastProperties(process);try{throw new Error}catch(t){j.lastLineError=t}e.exports=j},{"./es5":10}]},{},[3])(3)})),"undefined"!=typeof window&&null!==window?window.P=window.Promise:"undefined"!=typeof self&&null!==self&&(self.P=self.Promise),
/*!
 * chrome-promise 2.0.3
 * https://github.com/tfoxy/chrome-promise
 *
 * Copyright 2015 Tomás Fox
 * Released under the MIT license
 */
function(t,e){"function"==typeof define&&define.amd?define("lib/chrome-promise",[],e.bind(null,"object"==typeof exports?this:t)):"object"==typeof exports?module.exports=e(this):t.ChromePromise=e(t)}(this,(function(t){"use strict";var e=Array.prototype.slice,n=Object.prototype.hasOwnProperty;return function r(o){var i=(o=o||{}).chrome||t.chrome,a=o.Promise||t.Promise,s=i.runtime;function c(t,n){return function(){var r=e.call(arguments);return new a((function(o,i){r.push((function(){var t=s.lastError,n=e.call(arguments);if(t)i(t);else switch(n.length){case 0:o();break;case 1:o(n[0]);break;default:o(n)}})),t.apply(n,r)}))}}function u(t,e){for(var o in t)if(n.call(t,o)){var i=t[o],a=typeof i;"object"!==a||i instanceof r?e[o]="function"===a?c(i,t):i:(e[o]={},u(i,e[o]))}}u(i,this)}})),define("shared",[],(function(){const t=chrome.extension.getBackgroundPage(),e=t.shared||(t.shared={});return function(t,n){return e[t]||(e[t]="function"==typeof n?n():n)}})),define("cp",["lib/chrome-promise","shared","bluebird"],(function(t,e,n){return e("cp",(function(){return new t({Promise:n})}))})),define("background/constants",["shared"],(function(t){const{userAgent:e,platform:n,languages:r}=navigator,o=/Mac/i.test(n),i=/Linux/i.test(n),a=/Edg\//i.test(e),s=r[0],c=s.match(/^(?<lang>[-a-z]+)-(?<locale>[a-z]+)$/i);return t("k",(()=>({IsMac:o,IsLinux:i,Platform:o?"mac":"win",Language:c&&c.groups.lang||s,IsDev:!1,IsEdge:a,IncognitoNameUC:a?"InPrivate":"Incognito",IncognitoNameLC:a?"InPrivate":"incognito",SpaceBehavior:{Key:"spaceBehavior",Select:"select",Space:"space"},EscBehavior:{Key:"escBehavior",Clear:"clear",Close:"close"},HomeEndBehavior:{Key:"homeEndBehavior",ResultsList:"resultsList",SearchBox:"searchBox"},MarkTabsInOtherWindows:{Key:"markTabsInOtherWindows"},IncludeClosedTabs:{Key:"includeClosedTabs"},ShowTabCount:{Key:"showTabCount"},UsePinyin:{Key:"usePinyin"},RestoreLastQuery:{Key:"restoreLastQuery"},ShowBookmarkPaths:{Key:"showBookmarkPaths"},Shortcuts:{Key:"shortcuts",MRUSelect:"mruSelect",CloseTab:"closeTab",MoveTabLeft:"moveTabLeft",MoveTabRight:"moveTabRight",CopyURL:"copyURL",CopyTitleURL:"copyTitleURL"}})))})),define("lib/objects-have-same-keys",[],(()=>function t(e,n,r){const o=Object.keys(e).sort(),i=Object.keys(n).sort();return o.join()===i.join()&&o.every((o=>{const i=e[o],a=n[o],s=typeof i;return s===typeof a&&("object"!=s||(!i&&!a||Array.isArray(i)&&Array.isArray(a)||i&&a&&(!r||t(i,a,r))||!1))}))})),define("lib/decode",[],(function(){return function(t){let e=t;try{e=decodeURIComponent(t)}catch(n){try{e=unescape(t)}catch(t){}}return e}})),define("background/mutex",[],(function(){function t(t){this._locked=!1,this._queue=[],this._promiseConstructor=t||Promise}return Object.assign(t.prototype,{lock:function(t){return new this._promiseConstructor(function(e,n){this._queue.push([t,e,n]),this._locked||this._dequeue()}.bind(this))},_dequeue:function(){var t=this._queue.shift();t?(this._locked=!0,this._execute(t)):this._locked=!1},_execute:function(t){var e=t[0],n=t[1],r=t[2];e().then(n,r).then(function(){this._dequeue()}.bind(this))}}),t})),define("background/tracker",[],(function(){const t=/chrome-extension:\/\/[^\n]+\//g,e="object"==typeof window?window:{};if("function"!=typeof e.ga){function n(...t){n.q.push(t)}n.q=[],n.l=Date.now(),e.ga=n,e.GoogleAnalyticsObject="ga"}function r({id:t,name:n="t0",createFields:r={},settings:o={},sendPageview:i=!0}){if(!t||"string"!=typeof t)throw new Error("A Universal Analytics tracker ID is required.");this.name=n,this.enable(),this.ga("create",t,Object.assign({name:n},r)),e.location&&"chrome-extension:"==e.location.protocol&&this.set("checkProtocolTask",null),this.set(o),i&&this.pageview(),setTimeout((()=>{e.ga.answer||this.disable(!0)}),3e4)}return Object.assign(r.prototype,{enable:function(){this.enabled=!0},disable:function(t){this.enabled=!1,t&&!e.ga.answer&&(e.ga.q.length=0)},ga:function(t,...n){const r="create"==t?t:`${this.name}.${t}`;this.enabled&&e.ga(r,...n)},send:function(...t){this.ga("send",...t)},set:function(t,e){t&&"object"==typeof t?Object.keys(t).forEach((e=>this.ga("set",e,t[e]))):this.ga("set",t,e)},event:function(t,e,n){const r={hitType:"event",eventCategory:t,eventAction:e};"string"==typeof n?r.eventLabel=n:"number"==typeof n&&(r.eventValue=n),this.send(r)},pageview:function(t){t?this.send("pageview",t):this.send("pageview")},timing:function(t,e,n){this.send("timing",t,e,Math.round(n))},exception:function(e,n){let r;try{if(e){if("string"==typeof e)r=e;else if(e.stack)r=e.stack.replace(t,"").slice(0,2e3);else if(e.message){const t=e.lineno?`\n${e.lineno}, ${e.colno}: ${e.filename}`:"";r=`${e.message}${t}`}}else r="Generic error";this.send("exception",{exDescription:r,exFatal:Boolean(n)})}catch(t){console.error("Calling tracker.exception() failed.",t)}}}),r})),define("background/page-trackers",["shared","./tracker","./constants"],(function(t,e,{IsEdge:n}){const r="UA-108153491-"+(n?"4":"3");return t("trackers",(function(){return{background:new e({id:r,name:"background",settings:{location:"/background.html",page:"/background",transport:"beacon"},sendPageview:!1}),popup:new e({id:r,name:"popup",settings:{location:"/popup.html",page:"/popup",transport:"beacon"},sendPageview:!1}),options:new e({id:r,name:"options",settings:{location:"/options.html",page:"/options",transport:"beacon"},sendPageview:!1})}}))})),define("background/storage",["bluebird","cp","./mutex","./page-trackers"],(function(t,e,n,r){function o(){return t.resolve({})}function i(){return!0}function a(t){return t}return function({version:s=1,getDefaultData:c=o,validateUpdate:u=i,updaters:l={}}){const f=new n(t);let p=e.storage.local.get(null).then((t=>t&&t.data?async function(t){let e=!1,n=l[t.version];for(;n;){const[e,r]=await n(t.data,t.version);t.data=e,t.version=r,n=l[t.version]}if(t.version===s&&(e=await u(t.data)),e)return h(t.data);{const e=t.version===s?"failed-validation":"failed-update";return DEBUG&&console.error(`Storage error: ${e}`,t),r.background.event("storage",e),d()}}(t):d()));function h(t){return e.storage.local.set({version:s,data:t}).return(t)}function d(){return e.storage.local.clear().then(c).then(h).then((e=>p=t.resolve(e)))}function _(n,r,o){return f.lock((()=>p.then((i=>t.resolve(n.call(r,i)).then((t=>o&&t?(Object.assign(i,t),function(t){return e.storage.local.set({data:t}).return(t)}(i)):t))))))}return{get version(){return s},get:function(t,e){return _(t||a,e,!1)},set:function(t,e){return _(t,e,!0)},reset:function(){return f.lock(d)}}}})),define("background/get-default-settings",["./constants"],(function(t){const e={[t.Shortcuts.MRUSelect]:"w",[t.Shortcuts.CloseTab]:t.IsLinux?"ctrl+alt+w":"ctrl+w",[t.Shortcuts.MoveTabLeft]:"ctrl+[",[t.Shortcuts.MoveTabRight]:"ctrl+]",[t.Shortcuts.CopyURL]:"mod+c",[t.Shortcuts.CopyTitleURL]:"mod+shift+c"},n=Object.assign({},e,{[t.Shortcuts.CloseTab]:"cmd+ctrl+w"}),r={[t.SpaceBehavior.Key]:t.SpaceBehavior.Select,[t.EscBehavior.Key]:t.EscBehavior.Clear,[t.HomeEndBehavior.Key]:t.HomeEndBehavior.ResultsList,[t.MarkTabsInOtherWindows.Key]:!0,[t.IncludeClosedTabs.Key]:!0,[t.ShowTabCount.Key]:!1,[t.UsePinyin.Key]:!1,[t.RestoreLastQuery.Key]:!1,[t.ShowBookmarkPaths.Key]:!0,[t.Shortcuts.Key]:{mac:n,win:e}};return function(){return JSON.parse(JSON.stringify(r))}})),define("background/quickey-storage",["cp","shared","lib/objects-have-same-keys","lib/decode","./storage","./get-default-settings","./constants"],(function(t,e,n,r,o,i,a){return e("quickeyStorage",(()=>{function e(t){return parseInt(t)+1}function s(t){return async(n,r)=>(await t(n,r),r>=7&&!Number.isInteger(n.lastSeenOptionsVersion)&&(n.lastSeenOptionsVersion=7),[n,e(r)])}function c(...t){return async e=>{const n=(await p).settings;t.forEach((t=>{const{Key:r}=t,o=n[r];if(void 0===o)throw new Error(`addDefaultSetting(): no default value for "${t}"`);e.settings[r]=o}))}}const u={3:s((t=>{t.installTime=Date.now(),delete t.switchFromShortcut,delete t.lastShortcutTabID})),4:s((async t=>{t.settings=(await p).settings})),5:s((async t=>{await c(a.IncludeClosedTabs)(t),t.lastUsedVersion=""})),6:s(c(a.MarkTabsInOtherWindows)),7:s(c(a.ShowTabCount)),8:s(c(a.UsePinyin)),9:s((async t=>{await c(a.RestoreLastQuery,a.ShowBookmarkPaths,a.HomeEndBehavior)(t),t.lastQuery=""}))},l=e(Object.keys(u).sort(((t,e)=>t-e)).pop()),f=i(),p=Promise.all([t.windows.getAll(),t.tabs.query({})]).then((([t,e])=>{let n;try{n=/\p{Script=Han}/u}catch(t){}if(0==a.Language.indexOf("zh"))f[a.UsePinyin.Key]=!0;else if(n)for(let t=0,o=e.length;t<o;t++){const{title:o,url:i}=e[t];if(n.test(o)||n.test(r(i))){f[a.UsePinyin.Key]=!0;break}}return f[a.MarkTabsInOtherWindows.Key]=t.length<4,{installTime:Date.now(),lastShortcutTime:0,lastStartupTime:0,lastUpdateTime:0,lastUsedVersion:"",lastSeenOptionsVersion:l,lastQuery:"",previousTabIndex:-1,settings:f,tabIDs:[],tabsByID:{}}}));return o({version:l,updaters:u,getDefaultData:async function(){const e=await t.tabs.query({active:!0,currentWindow:!0,windowType:"normal"}),n=e&&e[0],r=JSON.parse(JSON.stringify(await p));return n&&(n.lastVisit=Date.now(),r.tabIDs.push(n.id),r.tabsByID[n.id]=n),r},validateUpdate:async function(t){const e=await p;return n(e,t,!1)&&n(e.settings,t.settings,!0)}})}))})),
/* @preserve ⌃⇧⌥⌘ */
define("background/get-chrome-shortcuts",["cp"],(function(t){const e={"Left Arrow":"ArrowLeft","Right Arrow":"ArrowRight","Up Arrow":"ArrowUp","Down Arrow":"ArrowDown","Page Up":"PageUp","Page Down":"PageDown",Ins:"Insert",Del:"Delete",Comma:",",Period:".","Media Previous Track":"MediaTrackPrevious","Media Next Track":"MediaTrackNext","Media Play/Pause":"MediaPlayPause","Media Stop":"MediaStop"},n=/([\u2303\u21E7\u2325\u2318]+)(.+)/;return e["←"]="ArrowLeft",e["→"]="ArrowRight",e["↑"]="ArrowUp",e["↓"]="ArrowDown",e["⌃"]="Ctrl",e["⇧"]="Shift",e["⌥"]="Opt",e["⌘"]="Cmd",function(){return t.commands.getAll().then((t=>t.map((t=>{const r=t.shortcut||"";let o;if(r.indexOf("Media")>-1)o=[r];else if(r.includes("+"))o=r.split("+");else{const t=r.match(n);o=t&&3==t.length?t[1].split("").concat(t[2]):[""]}const i=o.map((t=>e[t]||t)).join("+").toLowerCase();return{label:t.description||"Open the QuicKey menu",id:t.name,shortcut:i}}))))}})),define("options/key-constants",["background/constants"],(function({IsMac:t}){return{KeyOrder:{ctrl:0,control:0,mod:t?3:0,alt:1,opt:1,meta:t?1:-1,shift:2,cmd:3,char:4},ModifierAliases:{alt:t?"opt":"alt",mod:t?"cmd":"ctrl",control:"ctrl",meta:t?"cmd":""},ModifierEventNames:{alt:"Alt",opt:"Alt",ctrl:"Control",cmd:"Meta"},ModKeyBoolean:t?"metaKey":"ctrlKey",ShortcutSeparator:"+",FunctionKeyPattern:/^F\d{1,2}$/i}})),define("options/are-shortcuts-identical",["./key-constants"],(function({ModifierAliases:t,ShortcutSeparator:e}){function n(n){const r=String(n).split(e).map((function(e){const n=e.toLowerCase();return t[n]||n})),o=r.slice(0,-1),i=r.slice(-1);return{modifiers:o.sort(),baseKey:i.pop()}}return function(t,e){const r=n(t),o=n(e);return r.modifiers.join("")==o.modifiers.join("")&&r.baseKey==o.baseKey}})),define("background/settings",["bluebird","./quickey-storage","./get-default-settings","./get-chrome-shortcuts","options/key-constants","options/are-shortcuts-identical","./constants"],(function(t,e,n,r,o,i,{IsMac:a,Platform:s}){const c=a?"ctrl":"alt";function u(t){const e=Object.assign({},t.settings);return e.shortcuts=e.shortcuts[s],e}function l(t){const e=u(t);return r().then((t=>{const n=(t.filter((({id:t})=>"_execute_browser_action"==t))[0].shortcut||"").split("+"),r=n.slice(0,-1).filter((t=>"shift"!=t.toLowerCase()));return r.length||(r[0]=c),e.chrome={popup:{key:n.pop(),modifiers:r,modifierEventName:o.ModifierEventNames[r[0]]},shortcuts:t},e}))}return{get:function(t){return t&&"object"==typeof t?l(t):e.get().then(l)},getDefaults:function(){const t=u({settings:n()}),e=[c];return t.chrome={popup:{key:"",modifiers:e,modifierEventName:o.ModifierEventNames[e[0]]},shortcuts:[]},t},set:function(t,n){return e.set((({settings:e})=>{const r=e.shortcuts[s];return t in e?e[t]=n:(r[t]=n,Object.keys(r).forEach((e=>{e!==t&&i(r[e],n)&&(r[e]="")}))),{settings:e}})).then(l)},resetShortcuts:function(){return e.set((({settings:t})=>(t.shortcuts[s]=n().shortcuts[s],{settings:t}))).then(l)}}})),define("popup/data/add-urls",["lib/decode"],(function(t){const e=/^chrome-extension:\/\/[^/]+\/suspended\.html#(?:.*&)?uri=(.+)$/,n=/^((chrome-extension:\/\/[^/]+\/suspended\.html#(?:.*&)?uri=)?(https?|file|chrome):\/\/(www\.)?)|(chrome-extension:\/\/[^/]+\/)/,r="chrome://favicon/";return function(o,i){let{url:a,favIconUrl:s}=o;const c=a.replace(e,"$1");return i?(o.url=c,o.originalURL=a,o.faviconURL=r+c):(a!=c&&(o.unsuspendURL=c),o.faviconURL=s&&0!=s.indexOf("chrome-extension://klbibkeccnjlkjkiokjodocebajanakg/img/")?s:r+(o.unsuspendURL||a)),o.displayURL=t(a.replace(/\+/g,"%20")).replace(n,""),o.recentBoost=isNaN(o.recentBoost)?1:o.recentBoost,o}})),define("background/recent-tabs",["bluebird","cp","shared","popup/data/add-urls","./quickey-storage","./page-trackers"],(function(t,e,n,r,o,i){const a=["id","url","windowId"];function s(t,e){return t?(t.title||t.url).slice(0,e||75):"NO TAB"}function c(t,e){const n=a.reduce(((e,n)=>(e[n]=t[n],e)),{});return n.lastVisit=e&&e.lastVisit||0,n}function u(t){t.lastVisit=Date.now()}function l(t,e){DEBUG&&console.log("=== updateFromFreshTabs",t,e);const{tabIDs:n,tabsByID:o}=t,a={},s={},u=[],l=i.background;let f=0;DEBUG&&console.log("=== existing tabs",n.length,Object.keys(o).length,"fresh",e.length),e.forEach((t=>{r(t),a[t.url]=t,t.unsuspendURL&&(a[t.unsuspendURL]=t)})),n.forEach((t=>{const e=o[t];let n=a[e&&e.url];n?(n=c(n,e),s[n.id]=n,u.push(n.id),delete a[e.url]):(f++,DEBUG&&console.log("=== missing",t,e&&e.lastVisit,e&&e.url))})),DEBUG&&console.log("=== newTabIDs",u.length),l.timing("update","old-recents",n.length),l.timing("update","new-tabs",e.length),l.timing("update","missing-recents",f);var p={tabIDs:u,tabsByID:s,lastUpdateTime:Date.now()};return DEBUG&&console.log("updateFromFreshTabs result",p),p}function f(n){const r=Date.now(),i={lastShortcutTime:r,previousTabIndex:-1};return o.set((function o(a){const{tabIDs:c,tabsByID:u}=a,l=c.length,f=l-1;let p;r-a.lastShortcutTime<750&&a.previousTabIndex>-1?p=-1==n?(a.previousTabIndex-1+l)%l:Math.min(a.previousTabIndex+1,f):-1==n&&(p=f-1);const h=c[p];return h?(DEBUG&&console.log("navigate previousTabIndex",h,p,c.slice(-5),s(u[h])),i.previousTabIndex=p,t.resolve().then((()=>e.windows.update(u[h].windowId,{focused:!0}))).then((()=>e.tabs.update(h,{active:!0}))).catch((t=>(c.splice(p,1),delete u[h],a.previousTabIndex=p,i.tabIDs=c,i.tabsByID=u,DEBUG&&console.error(t),o(a)))).return(i)):i}),"navigate")}return n("recentTabs",{add:function(e,n){return e?o.set((({tabIDs:t,tabsByID:r})=>{const{id:o}=e,i=(a=t)[a.length-1];var a;const l=r[i];let f;return l&&l.url==e.url&&l.id==e.id&&l.windowId==e.windowId?(u(l),{tabsByID:r}):(f=c(e,r[o]),u(f),r[o]=f,function(t,e){let n=0,r=-1;do{r=t.indexOf(e,n),r>-1&&(t.splice(r,1),n=r)}while(r>-1)}(t,o),n?(t.splice(-1,0,o),l&&(l.lastVisit=f.lastVisit+1)):t.push(o),DEBUG&&console.log("add",`${e.id}|${e.windowId}`,t.slice(-5),s(e)),t.splice(0,Math.max(t.length-50,0)).forEach((t=>{delete r[t]})),{tabIDs:t,tabsByID:r})}),"addTab"):t.resolve()},remove:function(t){if(!isNaN(t))return o.set((({tabIDs:e,tabsByID:n})=>{const r=e.indexOf(t);return r>-1&&(DEBUG&&console.log("tab closed",t,s(n[t])),e.splice(r,1)),delete n[t],{tabIDs:e,tabsByID:n}}),"removeTab")},replace:function(t,e){return o.set((({tabIDs:n,tabsByID:r})=>{const o=n.indexOf(t),i=r[t],a={};return i&&(delete r[t],a.tabsByID=r),o>-1&&(DEBUG&&console.log("tab replaced",t,s(i)),n[o]=e,r[e]=i,r[e].id=e,a.tabIDs=n,a.tabsByID=r),a}),"replaceTab")},getAll:function(n){return o.get((i=>t.all([e.tabs.query({}),n?e.sessions.getRecentlyClosed():[]]).spread(((t,e)=>{const{tabIDs:n,lastUpdateTime:a,lastStartupTime:s}=i,u={};let f,{tabsByID:p}=i,h={tabsByID:p};if((isNaN(a)||s>a)&&(DEBUG&&console.log("====== calling updateFromFreshTabs"),h=l(i,t),p=h.tabsByID),f=t.map((t=>{const{id:e,url:n}=r(t),o=p[e];let i=0;return o&&(p[e]=c(t,o),i=p[e].lastVisit),t.lastVisit=i,u[n]=!0,t.unsuspendURL&&(u[t.unsuspendURL]=!0),t})),n.length>1){const t=[];e.forEach((e=>{const n=1e3*e.lastModified;[].concat(e.tab||e.window.tabs).forEach((e=>{e.url in u||(u[e.url]=!0,e.lastVisit=n,r(e),t.push(e))}))})),f=f.concat(t)}return o.set((()=>h)),f}))))},updateAll:function(){return o.set((t=>e.tabs.query({}).then((e=>(DEBUG&&console.log("=== updateAll"),l(t,e))))),"updateAll")},navigate:f,toggle:function(){return o.set((()=>({lastShortcutTime:0,previousTabIndex:-1})),"toggle").then((()=>f(-1)))},print:function(n=20){e.storage.local.get(null).then((({data:r})=>{const{tabsByID:o,tabIDs:i}=r;t.all(i.slice(-n).reverse().map((t=>e.tabs.get(t).catch((()=>t))))).then((t=>t.forEach((t=>{isNaN(t)?console.log("%c   ",`font-size: 14px; background: url(${t.favIconUrl}) top center / contain no-repeat`,`${t.id}|${t.windowId}: ${o[t.id].lastVisit}: ${s(t)}`):console.log("MISSING",t)}))))}))}})})),define("common/base",["lodash","bluebird","cp","shared","background/constants","background/quickey-storage","background/settings","background/recent-tabs","background/page-trackers"],(()=>{}));